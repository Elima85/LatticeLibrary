#ifndef IMAGEBCCTEST
#define IMAGEBCCTEST

#include "gtest/gtest.h"
#include "defs.h"
#include "cimage.h"
#include "cimageBCC.h"
#include "exception.h"
#include "label.h"
#include <cmath>
#include <vector>


using namespace CImage;

/**
 * Tests type CImageBCC<uint8>.
 */

TEST(CImageBCC, constructor) {

	// set up image
	int nR = 5, nC = 6, nL = 7, nB = 3;
	int N = nR * nC * nL;
	uint8 data[N * nB];
	for (int i = 0; i < nB * N; i++) {
		data[i] = i;
	}

	// constructor
	CImageBCC<uint8> *imBCC = new CImageBCC<uint8>(data, nR, nC, nL, nB);
	EXPECT_TRUE(imBCC);

	uint8* imdata = imBCC->getData();
    EXPECT_NEAR(imdata[0], data[0], EPSILONT);
    EXPECT_NEAR(imdata[1], data[1], EPSILONT);
    EXPECT_NEAR(imdata[2], data[2], EPSILONT);
    EXPECT_NEAR(imdata[3], data[3], EPSILONT);
    EXPECT_NEAR(imdata[4], data[4], EPSILONT);
    EXPECT_NEAR(imdata[5], data[5], EPSILONT);
    EXPECT_NEAR(imdata[6], data[6], EPSILONT);
    EXPECT_NEAR(imdata[7], data[7], EPSILONT);
    EXPECT_NEAR(imdata[8], data[8], EPSILONT);
    EXPECT_NEAR(imdata[9], data[9], EPSILONT);
    EXPECT_NEAR(imdata[10], data[10], EPSILONT);
    EXPECT_NEAR(imdata[11], data[11], EPSILONT);
    EXPECT_NEAR(imdata[12], data[12], EPSILONT);
    EXPECT_NEAR(imdata[13], data[13], EPSILONT);
    EXPECT_NEAR(imdata[14], data[14], EPSILONT);
    EXPECT_NEAR(imdata[15], data[15], EPSILONT);
    EXPECT_NEAR(imdata[16], data[16], EPSILONT);
    EXPECT_NEAR(imdata[17], data[17], EPSILONT);
    EXPECT_NEAR(imdata[18], data[18], EPSILONT);
    EXPECT_NEAR(imdata[19], data[19], EPSILONT);
    EXPECT_NEAR(imdata[20], data[20], EPSILONT);
    EXPECT_NEAR(imdata[21], data[21], EPSILONT);
    EXPECT_NEAR(imdata[22], data[22], EPSILONT);
    EXPECT_NEAR(imdata[23], data[23], EPSILONT);
    EXPECT_NEAR(imdata[24], data[24], EPSILONT);
    EXPECT_NEAR(imdata[25], data[25], EPSILONT);
    EXPECT_NEAR(imdata[26], data[26], EPSILONT);
    EXPECT_NEAR(imdata[27], data[27], EPSILONT);
    EXPECT_NEAR(imdata[28], data[28], EPSILONT);
    EXPECT_NEAR(imdata[29], data[29], EPSILONT);
    EXPECT_NEAR(imdata[30], data[30], EPSILONT);
    EXPECT_NEAR(imdata[31], data[31], EPSILONT);
    EXPECT_NEAR(imdata[32], data[32], EPSILONT);
    EXPECT_NEAR(imdata[33], data[33], EPSILONT);
    EXPECT_NEAR(imdata[34], data[34], EPSILONT);
    EXPECT_NEAR(imdata[35], data[35], EPSILONT);
    EXPECT_NEAR(imdata[36], data[36], EPSILONT);
    EXPECT_NEAR(imdata[37], data[37], EPSILONT);
    EXPECT_NEAR(imdata[38], data[38], EPSILONT);
    EXPECT_NEAR(imdata[39], data[39], EPSILONT);
    EXPECT_NEAR(imdata[40], data[40], EPSILONT);
    EXPECT_NEAR(imdata[41], data[41], EPSILONT);
    EXPECT_NEAR(imdata[42], data[42], EPSILONT);
    EXPECT_NEAR(imdata[43], data[43], EPSILONT);
    EXPECT_NEAR(imdata[44], data[44], EPSILONT);
    EXPECT_NEAR(imdata[45], data[45], EPSILONT);
    EXPECT_NEAR(imdata[46], data[46], EPSILONT);
    EXPECT_NEAR(imdata[47], data[47], EPSILONT);
    EXPECT_NEAR(imdata[48], data[48], EPSILONT);
    EXPECT_NEAR(imdata[49], data[49], EPSILONT);
    EXPECT_NEAR(imdata[50], data[50], EPSILONT);
    EXPECT_NEAR(imdata[51], data[51], EPSILONT);
    EXPECT_NEAR(imdata[52], data[52], EPSILONT);
    EXPECT_NEAR(imdata[53], data[53], EPSILONT);
    EXPECT_NEAR(imdata[54], data[54], EPSILONT);
    EXPECT_NEAR(imdata[55], data[55], EPSILONT);
    EXPECT_NEAR(imdata[56], data[56], EPSILONT);
    EXPECT_NEAR(imdata[57], data[57], EPSILONT);
    EXPECT_NEAR(imdata[58], data[58], EPSILONT);
    EXPECT_NEAR(imdata[59], data[59], EPSILONT);
    EXPECT_NEAR(imdata[60], data[60], EPSILONT);
    EXPECT_NEAR(imdata[61], data[61], EPSILONT);
    EXPECT_NEAR(imdata[62], data[62], EPSILONT);
    EXPECT_NEAR(imdata[63], data[63], EPSILONT);
    EXPECT_NEAR(imdata[64], data[64], EPSILONT);
    EXPECT_NEAR(imdata[65], data[65], EPSILONT);
    EXPECT_NEAR(imdata[66], data[66], EPSILONT);
    EXPECT_NEAR(imdata[67], data[67], EPSILONT);
    EXPECT_NEAR(imdata[68], data[68], EPSILONT);
    EXPECT_NEAR(imdata[69], data[69], EPSILONT);
    EXPECT_NEAR(imdata[70], data[70], EPSILONT);
    EXPECT_NEAR(imdata[71], data[71], EPSILONT);
    EXPECT_NEAR(imdata[72], data[72], EPSILONT);
    EXPECT_NEAR(imdata[73], data[73], EPSILONT);
    EXPECT_NEAR(imdata[74], data[74], EPSILONT);
    EXPECT_NEAR(imdata[75], data[75], EPSILONT);
    EXPECT_NEAR(imdata[76], data[76], EPSILONT);
    EXPECT_NEAR(imdata[77], data[77], EPSILONT);
    EXPECT_NEAR(imdata[78], data[78], EPSILONT);
    EXPECT_NEAR(imdata[79], data[79], EPSILONT);
    EXPECT_NEAR(imdata[80], data[80], EPSILONT);
    EXPECT_NEAR(imdata[81], data[81], EPSILONT);
    EXPECT_NEAR(imdata[82], data[82], EPSILONT);
    EXPECT_NEAR(imdata[83], data[83], EPSILONT);
    EXPECT_NEAR(imdata[84], data[84], EPSILONT);
    EXPECT_NEAR(imdata[85], data[85], EPSILONT);
    EXPECT_NEAR(imdata[86], data[86], EPSILONT);
    EXPECT_NEAR(imdata[87], data[87], EPSILONT);
    EXPECT_NEAR(imdata[88], data[88], EPSILONT);
    EXPECT_NEAR(imdata[89], data[89], EPSILONT);
    EXPECT_NEAR(imdata[90], data[90], EPSILONT);
    EXPECT_NEAR(imdata[91], data[91], EPSILONT);
    EXPECT_NEAR(imdata[92], data[92], EPSILONT);
    EXPECT_NEAR(imdata[93], data[93], EPSILONT);
    EXPECT_NEAR(imdata[94], data[94], EPSILONT);
    EXPECT_NEAR(imdata[95], data[95], EPSILONT);
    EXPECT_NEAR(imdata[96], data[96], EPSILONT);
    EXPECT_NEAR(imdata[97], data[97], EPSILONT);
    EXPECT_NEAR(imdata[98], data[98], EPSILONT);
    EXPECT_NEAR(imdata[99], data[99], EPSILONT);
    EXPECT_NEAR(imdata[100], data[100], EPSILONT);
    EXPECT_NEAR(imdata[101], data[101], EPSILONT);
    EXPECT_NEAR(imdata[102], data[102], EPSILONT);
    EXPECT_NEAR(imdata[103], data[103], EPSILONT);
    EXPECT_NEAR(imdata[104], data[104], EPSILONT);
    EXPECT_NEAR(imdata[105], data[105], EPSILONT);
    EXPECT_NEAR(imdata[106], data[106], EPSILONT);
    EXPECT_NEAR(imdata[107], data[107], EPSILONT);
    EXPECT_NEAR(imdata[108], data[108], EPSILONT);
    EXPECT_NEAR(imdata[109], data[109], EPSILONT);
    EXPECT_NEAR(imdata[110], data[110], EPSILONT);
    EXPECT_NEAR(imdata[111], data[111], EPSILONT);
    EXPECT_NEAR(imdata[112], data[112], EPSILONT);
    EXPECT_NEAR(imdata[113], data[113], EPSILONT);
    EXPECT_NEAR(imdata[114], data[114], EPSILONT);
    EXPECT_NEAR(imdata[115], data[115], EPSILONT);
    EXPECT_NEAR(imdata[116], data[116], EPSILONT);
    EXPECT_NEAR(imdata[117], data[117], EPSILONT);
    EXPECT_NEAR(imdata[118], data[118], EPSILONT);
    EXPECT_NEAR(imdata[119], data[119], EPSILONT);
    EXPECT_NEAR(imdata[120], data[120], EPSILONT);
    EXPECT_NEAR(imdata[121], data[121], EPSILONT);
    EXPECT_NEAR(imdata[122], data[122], EPSILONT);
    EXPECT_NEAR(imdata[123], data[123], EPSILONT);
    EXPECT_NEAR(imdata[124], data[124], EPSILONT);
    EXPECT_NEAR(imdata[125], data[125], EPSILONT);
    EXPECT_NEAR(imdata[126], data[126], EPSILONT);
    EXPECT_NEAR(imdata[127], data[127], EPSILONT);
    EXPECT_NEAR(imdata[128], data[128], EPSILONT);
    EXPECT_NEAR(imdata[129], data[129], EPSILONT);
    EXPECT_NEAR(imdata[130], data[130], EPSILONT);
    EXPECT_NEAR(imdata[131], data[131], EPSILONT);
    EXPECT_NEAR(imdata[132], data[132], EPSILONT);
    EXPECT_NEAR(imdata[133], data[133], EPSILONT);
    EXPECT_NEAR(imdata[134], data[134], EPSILONT);
    EXPECT_NEAR(imdata[135], data[135], EPSILONT);
    EXPECT_NEAR(imdata[136], data[136], EPSILONT);
    EXPECT_NEAR(imdata[137], data[137], EPSILONT);
    EXPECT_NEAR(imdata[138], data[138], EPSILONT);
    EXPECT_NEAR(imdata[139], data[139], EPSILONT);
    EXPECT_NEAR(imdata[140], data[140], EPSILONT);
    EXPECT_NEAR(imdata[141], data[141], EPSILONT);
    EXPECT_NEAR(imdata[142], data[142], EPSILONT);
    EXPECT_NEAR(imdata[143], data[143], EPSILONT);
    EXPECT_NEAR(imdata[144], data[144], EPSILONT);
    EXPECT_NEAR(imdata[145], data[145], EPSILONT);
    EXPECT_NEAR(imdata[146], data[146], EPSILONT);
    EXPECT_NEAR(imdata[147], data[147], EPSILONT);
    EXPECT_NEAR(imdata[148], data[148], EPSILONT);
    EXPECT_NEAR(imdata[149], data[149], EPSILONT);
    EXPECT_NEAR(imdata[150], data[150], EPSILONT);
    EXPECT_NEAR(imdata[151], data[151], EPSILONT);
    EXPECT_NEAR(imdata[152], data[152], EPSILONT);
    EXPECT_NEAR(imdata[153], data[153], EPSILONT);
    EXPECT_NEAR(imdata[154], data[154], EPSILONT);
    EXPECT_NEAR(imdata[155], data[155], EPSILONT);
    EXPECT_NEAR(imdata[156], data[156], EPSILONT);
    EXPECT_NEAR(imdata[157], data[157], EPSILONT);
    EXPECT_NEAR(imdata[158], data[158], EPSILONT);
    EXPECT_NEAR(imdata[159], data[159], EPSILONT);
    EXPECT_NEAR(imdata[160], data[160], EPSILONT);
    EXPECT_NEAR(imdata[161], data[161], EPSILONT);
    EXPECT_NEAR(imdata[162], data[162], EPSILONT);
    EXPECT_NEAR(imdata[163], data[163], EPSILONT);
    EXPECT_NEAR(imdata[164], data[164], EPSILONT);
    EXPECT_NEAR(imdata[165], data[165], EPSILONT);
    EXPECT_NEAR(imdata[166], data[166], EPSILONT);
    EXPECT_NEAR(imdata[167], data[167], EPSILONT);
    EXPECT_NEAR(imdata[168], data[168], EPSILONT);
    EXPECT_NEAR(imdata[169], data[169], EPSILONT);
    EXPECT_NEAR(imdata[170], data[170], EPSILONT);
    EXPECT_NEAR(imdata[171], data[171], EPSILONT);
    EXPECT_NEAR(imdata[172], data[172], EPSILONT);
    EXPECT_NEAR(imdata[173], data[173], EPSILONT);
    EXPECT_NEAR(imdata[174], data[174], EPSILONT);
    EXPECT_NEAR(imdata[175], data[175], EPSILONT);
    EXPECT_NEAR(imdata[176], data[176], EPSILONT);
    EXPECT_NEAR(imdata[177], data[177], EPSILONT);
    EXPECT_NEAR(imdata[178], data[178], EPSILONT);
    EXPECT_NEAR(imdata[179], data[179], EPSILONT);
    EXPECT_NEAR(imdata[180], data[180], EPSILONT);
    EXPECT_NEAR(imdata[181], data[181], EPSILONT);
    EXPECT_NEAR(imdata[182], data[182], EPSILONT);
    EXPECT_NEAR(imdata[183], data[183], EPSILONT);
    EXPECT_NEAR(imdata[184], data[184], EPSILONT);
    EXPECT_NEAR(imdata[185], data[185], EPSILONT);
    EXPECT_NEAR(imdata[186], data[186], EPSILONT);
    EXPECT_NEAR(imdata[187], data[187], EPSILONT);
    EXPECT_NEAR(imdata[188], data[188], EPSILONT);
    EXPECT_NEAR(imdata[189], data[189], EPSILONT);
    EXPECT_NEAR(imdata[190], data[190], EPSILONT);
    EXPECT_NEAR(imdata[191], data[191], EPSILONT);
    EXPECT_NEAR(imdata[192], data[192], EPSILONT);
    EXPECT_NEAR(imdata[193], data[193], EPSILONT);
    EXPECT_NEAR(imdata[194], data[194], EPSILONT);
    EXPECT_NEAR(imdata[195], data[195], EPSILONT);
    EXPECT_NEAR(imdata[196], data[196], EPSILONT);
    EXPECT_NEAR(imdata[197], data[197], EPSILONT);
    EXPECT_NEAR(imdata[198], data[198], EPSILONT);
    EXPECT_NEAR(imdata[199], data[199], EPSILONT);
    EXPECT_NEAR(imdata[200], data[200], EPSILONT);
    EXPECT_NEAR(imdata[201], data[201], EPSILONT);
    EXPECT_NEAR(imdata[202], data[202], EPSILONT);
    EXPECT_NEAR(imdata[203], data[203], EPSILONT);
    EXPECT_NEAR(imdata[204], data[204], EPSILONT);
    EXPECT_NEAR(imdata[205], data[205], EPSILONT);
    EXPECT_NEAR(imdata[206], data[206], EPSILONT);
    EXPECT_NEAR(imdata[207], data[207], EPSILONT);
    EXPECT_NEAR(imdata[208], data[208], EPSILONT);
    EXPECT_NEAR(imdata[209], data[209], EPSILONT);

    EXPECT_NEAR(imdata[210], data[210], EPSILONT);
    EXPECT_NEAR(imdata[211], data[211], EPSILONT);
    EXPECT_NEAR(imdata[212], data[212], EPSILONT);
    EXPECT_NEAR(imdata[213], data[213], EPSILONT);
    EXPECT_NEAR(imdata[214], data[214], EPSILONT);
    EXPECT_NEAR(imdata[215], data[215], EPSILONT);
    EXPECT_NEAR(imdata[216], data[216], EPSILONT);
    EXPECT_NEAR(imdata[217], data[217], EPSILONT);
    EXPECT_NEAR(imdata[218], data[218], EPSILONT);
    EXPECT_NEAR(imdata[219], data[219], EPSILONT);
    EXPECT_NEAR(imdata[220], data[220], EPSILONT);
    EXPECT_NEAR(imdata[221], data[221], EPSILONT);
    EXPECT_NEAR(imdata[222], data[222], EPSILONT);
    EXPECT_NEAR(imdata[223], data[223], EPSILONT);
    EXPECT_NEAR(imdata[224], data[224], EPSILONT);
    EXPECT_NEAR(imdata[225], data[225], EPSILONT);
    EXPECT_NEAR(imdata[226], data[226], EPSILONT);
    EXPECT_NEAR(imdata[227], data[227], EPSILONT);
    EXPECT_NEAR(imdata[228], data[228], EPSILONT);
    EXPECT_NEAR(imdata[229], data[229], EPSILONT);
    EXPECT_NEAR(imdata[230], data[230], EPSILONT);
    EXPECT_NEAR(imdata[231], data[231], EPSILONT);
    EXPECT_NEAR(imdata[232], data[232], EPSILONT);
    EXPECT_NEAR(imdata[233], data[233], EPSILONT);
    EXPECT_NEAR(imdata[234], data[234], EPSILONT);
    EXPECT_NEAR(imdata[235], data[235], EPSILONT);
    EXPECT_NEAR(imdata[236], data[236], EPSILONT);
    EXPECT_NEAR(imdata[237], data[237], EPSILONT);
    EXPECT_NEAR(imdata[238], data[238], EPSILONT);
    EXPECT_NEAR(imdata[239], data[239], EPSILONT);
    EXPECT_NEAR(imdata[240], data[240], EPSILONT);
    EXPECT_NEAR(imdata[241], data[241], EPSILONT);
    EXPECT_NEAR(imdata[242], data[242], EPSILONT);
    EXPECT_NEAR(imdata[243], data[243], EPSILONT);
    EXPECT_NEAR(imdata[244], data[244], EPSILONT);
    EXPECT_NEAR(imdata[245], data[245], EPSILONT);
    EXPECT_NEAR(imdata[246], data[246], EPSILONT);
    EXPECT_NEAR(imdata[247], data[247], EPSILONT);
    EXPECT_NEAR(imdata[248], data[248], EPSILONT);
    EXPECT_NEAR(imdata[249], data[249], EPSILONT);
    EXPECT_NEAR(imdata[250], data[250], EPSILONT);
    EXPECT_NEAR(imdata[251], data[251], EPSILONT);
    EXPECT_NEAR(imdata[252], data[252], EPSILONT);
    EXPECT_NEAR(imdata[253], data[253], EPSILONT);
    EXPECT_NEAR(imdata[254], data[254], EPSILONT);
    EXPECT_NEAR(imdata[255], data[255], EPSILONT);
    EXPECT_NEAR(imdata[256], data[256], EPSILONT);
    EXPECT_NEAR(imdata[257], data[257], EPSILONT);
    EXPECT_NEAR(imdata[258], data[258], EPSILONT);
    EXPECT_NEAR(imdata[259], data[259], EPSILONT);
    EXPECT_NEAR(imdata[260], data[260], EPSILONT);
    EXPECT_NEAR(imdata[261], data[261], EPSILONT);
    EXPECT_NEAR(imdata[262], data[262], EPSILONT);
    EXPECT_NEAR(imdata[263], data[263], EPSILONT);
    EXPECT_NEAR(imdata[264], data[264], EPSILONT);
    EXPECT_NEAR(imdata[265], data[265], EPSILONT);
    EXPECT_NEAR(imdata[266], data[266], EPSILONT);
    EXPECT_NEAR(imdata[267], data[267], EPSILONT);
    EXPECT_NEAR(imdata[268], data[268], EPSILONT);
    EXPECT_NEAR(imdata[269], data[269], EPSILONT);
    EXPECT_NEAR(imdata[270], data[270], EPSILONT);
    EXPECT_NEAR(imdata[271], data[271], EPSILONT);
    EXPECT_NEAR(imdata[272], data[272], EPSILONT);
    EXPECT_NEAR(imdata[273], data[273], EPSILONT);
    EXPECT_NEAR(imdata[274], data[274], EPSILONT);
    EXPECT_NEAR(imdata[275], data[275], EPSILONT);
    EXPECT_NEAR(imdata[276], data[276], EPSILONT);
    EXPECT_NEAR(imdata[277], data[277], EPSILONT);
    EXPECT_NEAR(imdata[278], data[278], EPSILONT);
    EXPECT_NEAR(imdata[279], data[279], EPSILONT);
    EXPECT_NEAR(imdata[280], data[280], EPSILONT);
    EXPECT_NEAR(imdata[281], data[281], EPSILONT);
    EXPECT_NEAR(imdata[282], data[282], EPSILONT);
    EXPECT_NEAR(imdata[283], data[283], EPSILONT);
    EXPECT_NEAR(imdata[284], data[284], EPSILONT);
    EXPECT_NEAR(imdata[285], data[285], EPSILONT);
    EXPECT_NEAR(imdata[286], data[286], EPSILONT);
    EXPECT_NEAR(imdata[287], data[287], EPSILONT);
    EXPECT_NEAR(imdata[288], data[288], EPSILONT);
    EXPECT_NEAR(imdata[289], data[289], EPSILONT);
    EXPECT_NEAR(imdata[290], data[290], EPSILONT);
    EXPECT_NEAR(imdata[291], data[291], EPSILONT);
    EXPECT_NEAR(imdata[292], data[292], EPSILONT);
    EXPECT_NEAR(imdata[293], data[293], EPSILONT);
    EXPECT_NEAR(imdata[294], data[294], EPSILONT);
    EXPECT_NEAR(imdata[295], data[295], EPSILONT);
    EXPECT_NEAR(imdata[296], data[296], EPSILONT);
    EXPECT_NEAR(imdata[297], data[297], EPSILONT);
    EXPECT_NEAR(imdata[298], data[298], EPSILONT);
    EXPECT_NEAR(imdata[299], data[299], EPSILONT);
    EXPECT_NEAR(imdata[300], data[300], EPSILONT);
    EXPECT_NEAR(imdata[301], data[301], EPSILONT);
    EXPECT_NEAR(imdata[302], data[302], EPSILONT);
    EXPECT_NEAR(imdata[303], data[303], EPSILONT);
    EXPECT_NEAR(imdata[304], data[304], EPSILONT);
    EXPECT_NEAR(imdata[305], data[305], EPSILONT);
    EXPECT_NEAR(imdata[306], data[306], EPSILONT);
    EXPECT_NEAR(imdata[307], data[307], EPSILONT);
    EXPECT_NEAR(imdata[308], data[308], EPSILONT);
    EXPECT_NEAR(imdata[309], data[309], EPSILONT);
    EXPECT_NEAR(imdata[310], data[310], EPSILONT);
    EXPECT_NEAR(imdata[311], data[311], EPSILONT);
    EXPECT_NEAR(imdata[312], data[312], EPSILONT);
    EXPECT_NEAR(imdata[313], data[313], EPSILONT);
    EXPECT_NEAR(imdata[314], data[314], EPSILONT);
    EXPECT_NEAR(imdata[315], data[315], EPSILONT);
    EXPECT_NEAR(imdata[316], data[316], EPSILONT);
    EXPECT_NEAR(imdata[317], data[317], EPSILONT);
    EXPECT_NEAR(imdata[318], data[318], EPSILONT);
    EXPECT_NEAR(imdata[319], data[319], EPSILONT);
    EXPECT_NEAR(imdata[320], data[320], EPSILONT);
    EXPECT_NEAR(imdata[321], data[321], EPSILONT);
    EXPECT_NEAR(imdata[322], data[322], EPSILONT);
    EXPECT_NEAR(imdata[323], data[323], EPSILONT);
    EXPECT_NEAR(imdata[324], data[324], EPSILONT);
    EXPECT_NEAR(imdata[325], data[325], EPSILONT);
    EXPECT_NEAR(imdata[326], data[326], EPSILONT);
    EXPECT_NEAR(imdata[327], data[327], EPSILONT);
    EXPECT_NEAR(imdata[328], data[328], EPSILONT);
    EXPECT_NEAR(imdata[329], data[329], EPSILONT);
    EXPECT_NEAR(imdata[330], data[330], EPSILONT);
    EXPECT_NEAR(imdata[331], data[331], EPSILONT);
    EXPECT_NEAR(imdata[332], data[332], EPSILONT);
    EXPECT_NEAR(imdata[333], data[333], EPSILONT);
    EXPECT_NEAR(imdata[334], data[334], EPSILONT);
    EXPECT_NEAR(imdata[335], data[335], EPSILONT);
    EXPECT_NEAR(imdata[336], data[336], EPSILONT);
    EXPECT_NEAR(imdata[337], data[337], EPSILONT);
    EXPECT_NEAR(imdata[338], data[338], EPSILONT);
    EXPECT_NEAR(imdata[339], data[339], EPSILONT);
    EXPECT_NEAR(imdata[340], data[340], EPSILONT);
    EXPECT_NEAR(imdata[341], data[341], EPSILONT);
    EXPECT_NEAR(imdata[342], data[342], EPSILONT);
    EXPECT_NEAR(imdata[343], data[343], EPSILONT);
    EXPECT_NEAR(imdata[344], data[344], EPSILONT);
    EXPECT_NEAR(imdata[345], data[345], EPSILONT);
    EXPECT_NEAR(imdata[346], data[346], EPSILONT);
    EXPECT_NEAR(imdata[347], data[347], EPSILONT);
    EXPECT_NEAR(imdata[348], data[348], EPSILONT);
    EXPECT_NEAR(imdata[349], data[349], EPSILONT);
    EXPECT_NEAR(imdata[350], data[350], EPSILONT);
    EXPECT_NEAR(imdata[351], data[351], EPSILONT);
    EXPECT_NEAR(imdata[352], data[352], EPSILONT);
    EXPECT_NEAR(imdata[353], data[353], EPSILONT);
    EXPECT_NEAR(imdata[354], data[354], EPSILONT);
    EXPECT_NEAR(imdata[355], data[355], EPSILONT);
    EXPECT_NEAR(imdata[356], data[356], EPSILONT);
    EXPECT_NEAR(imdata[357], data[357], EPSILONT);
    EXPECT_NEAR(imdata[358], data[358], EPSILONT);
    EXPECT_NEAR(imdata[359], data[359], EPSILONT);
    EXPECT_NEAR(imdata[360], data[360], EPSILONT);
    EXPECT_NEAR(imdata[361], data[361], EPSILONT);
    EXPECT_NEAR(imdata[362], data[362], EPSILONT);
    EXPECT_NEAR(imdata[363], data[363], EPSILONT);
    EXPECT_NEAR(imdata[364], data[364], EPSILONT);
    EXPECT_NEAR(imdata[365], data[365], EPSILONT);
    EXPECT_NEAR(imdata[366], data[366], EPSILONT);
    EXPECT_NEAR(imdata[367], data[367], EPSILONT);
    EXPECT_NEAR(imdata[368], data[368], EPSILONT);
    EXPECT_NEAR(imdata[369], data[369], EPSILONT);
    EXPECT_NEAR(imdata[370], data[370], EPSILONT);
    EXPECT_NEAR(imdata[371], data[371], EPSILONT);
    EXPECT_NEAR(imdata[372], data[372], EPSILONT);
    EXPECT_NEAR(imdata[373], data[373], EPSILONT);
    EXPECT_NEAR(imdata[374], data[374], EPSILONT);
    EXPECT_NEAR(imdata[375], data[375], EPSILONT);
    EXPECT_NEAR(imdata[376], data[376], EPSILONT);
    EXPECT_NEAR(imdata[377], data[377], EPSILONT);
    EXPECT_NEAR(imdata[378], data[378], EPSILONT);
    EXPECT_NEAR(imdata[379], data[379], EPSILONT);
    EXPECT_NEAR(imdata[380], data[380], EPSILONT);
    EXPECT_NEAR(imdata[381], data[381], EPSILONT);
    EXPECT_NEAR(imdata[382], data[382], EPSILONT);
    EXPECT_NEAR(imdata[383], data[383], EPSILONT);
    EXPECT_NEAR(imdata[384], data[384], EPSILONT);
    EXPECT_NEAR(imdata[385], data[385], EPSILONT);
    EXPECT_NEAR(imdata[386], data[386], EPSILONT);
    EXPECT_NEAR(imdata[387], data[387], EPSILONT);
    EXPECT_NEAR(imdata[388], data[388], EPSILONT);
    EXPECT_NEAR(imdata[389], data[389], EPSILONT);
    EXPECT_NEAR(imdata[390], data[390], EPSILONT);
    EXPECT_NEAR(imdata[391], data[391], EPSILONT);
    EXPECT_NEAR(imdata[392], data[392], EPSILONT);
    EXPECT_NEAR(imdata[393], data[393], EPSILONT);
    EXPECT_NEAR(imdata[394], data[394], EPSILONT);
    EXPECT_NEAR(imdata[395], data[395], EPSILONT);
    EXPECT_NEAR(imdata[396], data[396], EPSILONT);
    EXPECT_NEAR(imdata[397], data[397], EPSILONT);
    EXPECT_NEAR(imdata[398], data[398], EPSILONT);
    EXPECT_NEAR(imdata[399], data[399], EPSILONT);
    EXPECT_NEAR(imdata[400], data[400], EPSILONT);
    EXPECT_NEAR(imdata[401], data[401], EPSILONT);
    EXPECT_NEAR(imdata[402], data[402], EPSILONT);
    EXPECT_NEAR(imdata[403], data[403], EPSILONT);
    EXPECT_NEAR(imdata[404], data[404], EPSILONT);
    EXPECT_NEAR(imdata[405], data[405], EPSILONT);
    EXPECT_NEAR(imdata[406], data[406], EPSILONT);
    EXPECT_NEAR(imdata[407], data[407], EPSILONT);
    EXPECT_NEAR(imdata[408], data[408], EPSILONT);
    EXPECT_NEAR(imdata[409], data[409], EPSILONT);
    EXPECT_NEAR(imdata[410], data[410], EPSILONT);
    EXPECT_NEAR(imdata[411], data[411], EPSILONT);
    EXPECT_NEAR(imdata[412], data[412], EPSILONT);
    EXPECT_NEAR(imdata[413], data[413], EPSILONT);
    EXPECT_NEAR(imdata[414], data[414], EPSILONT);
    EXPECT_NEAR(imdata[415], data[415], EPSILONT);
    EXPECT_NEAR(imdata[416], data[416], EPSILONT);
    EXPECT_NEAR(imdata[417], data[417], EPSILONT);
    EXPECT_NEAR(imdata[418], data[418], EPSILONT);
    EXPECT_NEAR(imdata[419], data[419], EPSILONT);

    EXPECT_NEAR(imdata[420], data[420], EPSILONT);
    EXPECT_NEAR(imdata[421], data[421], EPSILONT);
    EXPECT_NEAR(imdata[422], data[422], EPSILONT);
    EXPECT_NEAR(imdata[423], data[423], EPSILONT);
    EXPECT_NEAR(imdata[424], data[424], EPSILONT);
    EXPECT_NEAR(imdata[425], data[425], EPSILONT);
    EXPECT_NEAR(imdata[426], data[426], EPSILONT);
    EXPECT_NEAR(imdata[427], data[427], EPSILONT);
    EXPECT_NEAR(imdata[428], data[428], EPSILONT);
    EXPECT_NEAR(imdata[429], data[429], EPSILONT);
    EXPECT_NEAR(imdata[430], data[430], EPSILONT);
    EXPECT_NEAR(imdata[431], data[431], EPSILONT);
    EXPECT_NEAR(imdata[432], data[432], EPSILONT);
    EXPECT_NEAR(imdata[433], data[433], EPSILONT);
    EXPECT_NEAR(imdata[434], data[434], EPSILONT);
    EXPECT_NEAR(imdata[435], data[435], EPSILONT);
    EXPECT_NEAR(imdata[436], data[436], EPSILONT);
    EXPECT_NEAR(imdata[437], data[437], EPSILONT);
    EXPECT_NEAR(imdata[438], data[438], EPSILONT);
    EXPECT_NEAR(imdata[439], data[439], EPSILONT);
    EXPECT_NEAR(imdata[440], data[440], EPSILONT);
    EXPECT_NEAR(imdata[441], data[441], EPSILONT);
    EXPECT_NEAR(imdata[442], data[442], EPSILONT);
    EXPECT_NEAR(imdata[443], data[443], EPSILONT);
    EXPECT_NEAR(imdata[444], data[444], EPSILONT);
    EXPECT_NEAR(imdata[445], data[445], EPSILONT);
    EXPECT_NEAR(imdata[446], data[446], EPSILONT);
    EXPECT_NEAR(imdata[447], data[447], EPSILONT);
    EXPECT_NEAR(imdata[448], data[448], EPSILONT);
    EXPECT_NEAR(imdata[449], data[449], EPSILONT);
    EXPECT_NEAR(imdata[450], data[450], EPSILONT);
    EXPECT_NEAR(imdata[451], data[451], EPSILONT);
    EXPECT_NEAR(imdata[452], data[452], EPSILONT);
    EXPECT_NEAR(imdata[453], data[453], EPSILONT);
    EXPECT_NEAR(imdata[454], data[454], EPSILONT);
    EXPECT_NEAR(imdata[455], data[455], EPSILONT);
    EXPECT_NEAR(imdata[456], data[456], EPSILONT);
    EXPECT_NEAR(imdata[457], data[457], EPSILONT);
    EXPECT_NEAR(imdata[458], data[458], EPSILONT);
    EXPECT_NEAR(imdata[459], data[459], EPSILONT);
    EXPECT_NEAR(imdata[460], data[460], EPSILONT);
    EXPECT_NEAR(imdata[461], data[461], EPSILONT);
    EXPECT_NEAR(imdata[462], data[462], EPSILONT);
    EXPECT_NEAR(imdata[463], data[463], EPSILONT);
    EXPECT_NEAR(imdata[464], data[464], EPSILONT);
    EXPECT_NEAR(imdata[465], data[465], EPSILONT);
    EXPECT_NEAR(imdata[466], data[466], EPSILONT);
    EXPECT_NEAR(imdata[467], data[467], EPSILONT);
    EXPECT_NEAR(imdata[468], data[468], EPSILONT);
    EXPECT_NEAR(imdata[469], data[469], EPSILONT);
    EXPECT_NEAR(imdata[470], data[470], EPSILONT);
    EXPECT_NEAR(imdata[471], data[471], EPSILONT);
    EXPECT_NEAR(imdata[472], data[472], EPSILONT);
    EXPECT_NEAR(imdata[473], data[473], EPSILONT);
    EXPECT_NEAR(imdata[474], data[474], EPSILONT);
    EXPECT_NEAR(imdata[475], data[475], EPSILONT);
    EXPECT_NEAR(imdata[476], data[476], EPSILONT);
    EXPECT_NEAR(imdata[477], data[477], EPSILONT);
    EXPECT_NEAR(imdata[478], data[478], EPSILONT);
    EXPECT_NEAR(imdata[479], data[479], EPSILONT);
    EXPECT_NEAR(imdata[480], data[480], EPSILONT);
    EXPECT_NEAR(imdata[481], data[481], EPSILONT);
    EXPECT_NEAR(imdata[482], data[482], EPSILONT);
    EXPECT_NEAR(imdata[483], data[483], EPSILONT);
    EXPECT_NEAR(imdata[484], data[484], EPSILONT);
    EXPECT_NEAR(imdata[485], data[485], EPSILONT);
    EXPECT_NEAR(imdata[486], data[486], EPSILONT);
    EXPECT_NEAR(imdata[487], data[487], EPSILONT);
    EXPECT_NEAR(imdata[488], data[488], EPSILONT);
    EXPECT_NEAR(imdata[489], data[489], EPSILONT);
    EXPECT_NEAR(imdata[490], data[490], EPSILONT);
    EXPECT_NEAR(imdata[491], data[491], EPSILONT);
    EXPECT_NEAR(imdata[492], data[492], EPSILONT);
    EXPECT_NEAR(imdata[493], data[493], EPSILONT);
    EXPECT_NEAR(imdata[494], data[494], EPSILONT);
    EXPECT_NEAR(imdata[495], data[495], EPSILONT);
    EXPECT_NEAR(imdata[496], data[496], EPSILONT);
    EXPECT_NEAR(imdata[497], data[497], EPSILONT);
    EXPECT_NEAR(imdata[498], data[498], EPSILONT);
    EXPECT_NEAR(imdata[499], data[499], EPSILONT);
    EXPECT_NEAR(imdata[500], data[500], EPSILONT);
    EXPECT_NEAR(imdata[501], data[501], EPSILONT);
    EXPECT_NEAR(imdata[502], data[502], EPSILONT);
    EXPECT_NEAR(imdata[503], data[503], EPSILONT);
    EXPECT_NEAR(imdata[504], data[504], EPSILONT);
    EXPECT_NEAR(imdata[505], data[505], EPSILONT);
    EXPECT_NEAR(imdata[506], data[506], EPSILONT);
    EXPECT_NEAR(imdata[507], data[507], EPSILONT);
    EXPECT_NEAR(imdata[508], data[508], EPSILONT);
    EXPECT_NEAR(imdata[509], data[509], EPSILONT);
    EXPECT_NEAR(imdata[510], data[510], EPSILONT);
    EXPECT_NEAR(imdata[511], data[511], EPSILONT);
    EXPECT_NEAR(imdata[512], data[512], EPSILONT);
    EXPECT_NEAR(imdata[513], data[513], EPSILONT);
    EXPECT_NEAR(imdata[514], data[514], EPSILONT);
    EXPECT_NEAR(imdata[515], data[515], EPSILONT);
    EXPECT_NEAR(imdata[516], data[516], EPSILONT);
    EXPECT_NEAR(imdata[517], data[517], EPSILONT);
    EXPECT_NEAR(imdata[518], data[518], EPSILONT);
    EXPECT_NEAR(imdata[519], data[519], EPSILONT);
    EXPECT_NEAR(imdata[520], data[520], EPSILONT);
    EXPECT_NEAR(imdata[521], data[521], EPSILONT);
    EXPECT_NEAR(imdata[522], data[522], EPSILONT);
    EXPECT_NEAR(imdata[523], data[523], EPSILONT);
    EXPECT_NEAR(imdata[524], data[524], EPSILONT);
    EXPECT_NEAR(imdata[525], data[525], EPSILONT);
    EXPECT_NEAR(imdata[526], data[526], EPSILONT);
    EXPECT_NEAR(imdata[527], data[527], EPSILONT);
    EXPECT_NEAR(imdata[528], data[528], EPSILONT);
    EXPECT_NEAR(imdata[529], data[529], EPSILONT);
    EXPECT_NEAR(imdata[530], data[530], EPSILONT);
    EXPECT_NEAR(imdata[531], data[531], EPSILONT);
    EXPECT_NEAR(imdata[532], data[532], EPSILONT);
    EXPECT_NEAR(imdata[533], data[533], EPSILONT);
    EXPECT_NEAR(imdata[534], data[534], EPSILONT);
    EXPECT_NEAR(imdata[535], data[535], EPSILONT);
    EXPECT_NEAR(imdata[536], data[536], EPSILONT);
    EXPECT_NEAR(imdata[537], data[537], EPSILONT);
    EXPECT_NEAR(imdata[538], data[538], EPSILONT);
    EXPECT_NEAR(imdata[539], data[539], EPSILONT);
    EXPECT_NEAR(imdata[540], data[540], EPSILONT);
    EXPECT_NEAR(imdata[541], data[541], EPSILONT);
    EXPECT_NEAR(imdata[542], data[542], EPSILONT);
    EXPECT_NEAR(imdata[543], data[543], EPSILONT);
    EXPECT_NEAR(imdata[544], data[544], EPSILONT);
    EXPECT_NEAR(imdata[545], data[545], EPSILONT);
    EXPECT_NEAR(imdata[546], data[546], EPSILONT);
    EXPECT_NEAR(imdata[547], data[547], EPSILONT);
    EXPECT_NEAR(imdata[548], data[548], EPSILONT);
    EXPECT_NEAR(imdata[549], data[549], EPSILONT);
    EXPECT_NEAR(imdata[550], data[550], EPSILONT);
    EXPECT_NEAR(imdata[551], data[551], EPSILONT);
    EXPECT_NEAR(imdata[552], data[552], EPSILONT);
    EXPECT_NEAR(imdata[553], data[553], EPSILONT);
    EXPECT_NEAR(imdata[554], data[554], EPSILONT);
    EXPECT_NEAR(imdata[555], data[555], EPSILONT);
    EXPECT_NEAR(imdata[556], data[556], EPSILONT);
    EXPECT_NEAR(imdata[557], data[557], EPSILONT);
    EXPECT_NEAR(imdata[558], data[558], EPSILONT);
    EXPECT_NEAR(imdata[559], data[559], EPSILONT);
    EXPECT_NEAR(imdata[560], data[560], EPSILONT);
    EXPECT_NEAR(imdata[561], data[561], EPSILONT);
    EXPECT_NEAR(imdata[562], data[562], EPSILONT);
    EXPECT_NEAR(imdata[563], data[563], EPSILONT);
    EXPECT_NEAR(imdata[564], data[564], EPSILONT);
    EXPECT_NEAR(imdata[565], data[565], EPSILONT);
    EXPECT_NEAR(imdata[566], data[566], EPSILONT);
    EXPECT_NEAR(imdata[567], data[567], EPSILONT);
    EXPECT_NEAR(imdata[568], data[568], EPSILONT);
    EXPECT_NEAR(imdata[569], data[569], EPSILONT);
    EXPECT_NEAR(imdata[570], data[570], EPSILONT);
    EXPECT_NEAR(imdata[571], data[571], EPSILONT);
    EXPECT_NEAR(imdata[572], data[572], EPSILONT);
    EXPECT_NEAR(imdata[573], data[573], EPSILONT);
    EXPECT_NEAR(imdata[574], data[574], EPSILONT);
    EXPECT_NEAR(imdata[575], data[575], EPSILONT);
    EXPECT_NEAR(imdata[576], data[576], EPSILONT);
    EXPECT_NEAR(imdata[577], data[577], EPSILONT);
    EXPECT_NEAR(imdata[578], data[578], EPSILONT);
    EXPECT_NEAR(imdata[579], data[579], EPSILONT);
    EXPECT_NEAR(imdata[580], data[580], EPSILONT);
    EXPECT_NEAR(imdata[581], data[581], EPSILONT);
    EXPECT_NEAR(imdata[582], data[582], EPSILONT);
    EXPECT_NEAR(imdata[583], data[583], EPSILONT);
    EXPECT_NEAR(imdata[584], data[584], EPSILONT);
    EXPECT_NEAR(imdata[585], data[585], EPSILONT);
    EXPECT_NEAR(imdata[586], data[586], EPSILONT);
    EXPECT_NEAR(imdata[587], data[587], EPSILONT);
    EXPECT_NEAR(imdata[588], data[588], EPSILONT);
    EXPECT_NEAR(imdata[589], data[589], EPSILONT);
    EXPECT_NEAR(imdata[590], data[590], EPSILONT);
    EXPECT_NEAR(imdata[591], data[591], EPSILONT);
    EXPECT_NEAR(imdata[592], data[592], EPSILONT);
    EXPECT_NEAR(imdata[593], data[593], EPSILONT);
    EXPECT_NEAR(imdata[594], data[594], EPSILONT);
    EXPECT_NEAR(imdata[595], data[595], EPSILONT);
    EXPECT_NEAR(imdata[596], data[596], EPSILONT);
    EXPECT_NEAR(imdata[597], data[597], EPSILONT);
    EXPECT_NEAR(imdata[598], data[598], EPSILONT);
    EXPECT_NEAR(imdata[599], data[599], EPSILONT);
    EXPECT_NEAR(imdata[600], data[600], EPSILONT);
    EXPECT_NEAR(imdata[601], data[601], EPSILONT);
    EXPECT_NEAR(imdata[602], data[602], EPSILONT);
    EXPECT_NEAR(imdata[603], data[603], EPSILONT);
    EXPECT_NEAR(imdata[604], data[604], EPSILONT);
    EXPECT_NEAR(imdata[605], data[605], EPSILONT);
    EXPECT_NEAR(imdata[606], data[606], EPSILONT);
    EXPECT_NEAR(imdata[607], data[607], EPSILONT);
    EXPECT_NEAR(imdata[608], data[608], EPSILONT);
    EXPECT_NEAR(imdata[609], data[609], EPSILONT);
    EXPECT_NEAR(imdata[610], data[610], EPSILONT);
    EXPECT_NEAR(imdata[611], data[611], EPSILONT);
    EXPECT_NEAR(imdata[612], data[612], EPSILONT);
    EXPECT_NEAR(imdata[613], data[613], EPSILONT);
    EXPECT_NEAR(imdata[614], data[614], EPSILONT);
    EXPECT_NEAR(imdata[615], data[615], EPSILONT);
    EXPECT_NEAR(imdata[616], data[616], EPSILONT);
    EXPECT_NEAR(imdata[617], data[617], EPSILONT);
    EXPECT_NEAR(imdata[618], data[618], EPSILONT);
    EXPECT_NEAR(imdata[619], data[619], EPSILONT);
    EXPECT_NEAR(imdata[620], data[620], EPSILONT);
    EXPECT_NEAR(imdata[621], data[621], EPSILONT);
    EXPECT_NEAR(imdata[622], data[622], EPSILONT);
    EXPECT_NEAR(imdata[623], data[623], EPSILONT);
    EXPECT_NEAR(imdata[624], data[624], EPSILONT);
    EXPECT_NEAR(imdata[625], data[625], EPSILONT);
    EXPECT_NEAR(imdata[626], data[626], EPSILONT);
    EXPECT_NEAR(imdata[627], data[627], EPSILONT);
    EXPECT_NEAR(imdata[628], data[628], EPSILONT);
    EXPECT_NEAR(imdata[629], data[629], EPSILONT);

	EXPECT_EQ(imBCC->getNElements(), N);
	EXPECT_NE(imBCC->getNElements(), N + 1);

    EXPECT_EQ(imBCC->getNColumns(), nC);
    EXPECT_NE(imBCC->getNColumns(), nC + 1);

    EXPECT_EQ(imBCC->getNRows(), nR);
    EXPECT_NE(imBCC->getNRows(), nR + 1);

    EXPECT_EQ(imBCC->getNLayers(), nL);
    EXPECT_NE(imBCC->getNLayers(), nL + 1);

    EXPECT_EQ(imBCC->getNBands(), nB);
    EXPECT_NE(imBCC->getNBands(), nB + 1);

	// validity of elements
	EXPECT_TRUE(!imBCC->isValid(-1));
	EXPECT_TRUE(imBCC->isValid(0));
	EXPECT_TRUE(imBCC->isValid(N - 1));
	EXPECT_TRUE(!imBCC->isValid(N));

	EXPECT_TRUE(!imBCC->isValid(0, -1));
	EXPECT_TRUE(!imBCC->isValid(N - 1, -1));
	EXPECT_TRUE(!imBCC->isValid(-1, 0));
	EXPECT_TRUE(imBCC->isValid(0, 0));
	EXPECT_TRUE(imBCC->isValid(N - 1, 0));
	EXPECT_TRUE(!imBCC->isValid(N, 0));
	EXPECT_TRUE(imBCC->isValid(0, nB - 1));
	EXPECT_TRUE(imBCC->isValid(N - 1, nB - 1));
	EXPECT_TRUE(!imBCC->isValid(0, nB));
	EXPECT_TRUE(!imBCC->isValid(N - 1, nB));

	EXPECT_TRUE(!imBCC->isValid(-1, 0, 0));
	EXPECT_TRUE(!imBCC->isValid(0, -1, 0));
	EXPECT_TRUE(!imBCC->isValid(0, 0, -1));
	EXPECT_TRUE(imBCC->isValid(0, 0, 0));
	EXPECT_TRUE(imBCC->isValid(nR - 1, 0, 0));
	EXPECT_TRUE(imBCC->isValid(0, nC - 1, 0));
	EXPECT_TRUE(imBCC->isValid(0, 0, nL - 1));
	EXPECT_TRUE(!imBCC->isValid(nR, 0, 0));
	EXPECT_TRUE(!imBCC->isValid(0, nC, 0));
	EXPECT_TRUE(!imBCC->isValid(0, 0, nL));

	EXPECT_TRUE(!imBCC->isValid(0, 0, 0, -1));
	EXPECT_TRUE(!imBCC->isValid(nR - 1, 0, 0, -1));
	EXPECT_TRUE(!imBCC->isValid(0, nC - 1, 0, -1));
	EXPECT_TRUE(!imBCC->isValid(0, 0, nL - 1, -1));
	EXPECT_TRUE(!imBCC->isValid(0, 0, 0, nB));
	EXPECT_TRUE(!imBCC->isValid(nR - 1, 0, 0, nB));
	EXPECT_TRUE(!imBCC->isValid(0, nC - 1, 0, nB));
	EXPECT_TRUE(!imBCC->isValid(0, 0, nL - 1, nB));
	EXPECT_TRUE(imBCC->isValid(0, 0, 0, nB - 1));
	EXPECT_TRUE(imBCC->isValid(nR - 1, 0, 0, nB - 1));
	EXPECT_TRUE(imBCC->isValid(0, nC - 1, 0, nB - 1));
	EXPECT_TRUE(imBCC->isValid(0, 0, nL - 1, nB - 1));

	// index conversion
    EXPECT_EQ(imBCC->rclToIndex(0, 0, 0), 0);
    EXPECT_EQ(imBCC->rclToIndex(1, 2, 3), 98);
    EXPECT_EQ(imBCC->rclToIndex(nR - 1, nC - 1, nL - 1), N - 1);

    EXPECT_EQ(imBCC->indexToR(0), 0);
    EXPECT_EQ(imBCC->indexToC(0), 0);
    EXPECT_EQ(imBCC->indexToL(0), 0);
    EXPECT_EQ(imBCC->indexToR(98), 1);
    EXPECT_EQ(imBCC->indexToC(98), 2);
    EXPECT_EQ(imBCC->indexToL(98), 3);
    EXPECT_EQ(imBCC->indexToR(N - 1), nR - 1);
    EXPECT_EQ(imBCC->indexToC(N - 1), nC - 1);
    EXPECT_EQ(imBCC->indexToL(N - 1), nL - 1);

	delete imBCC;
}

TEST(CImageBCC, coordinates) {

	// set up image
	int nR = 5, nC = 6, nL = 7, nB = 3;
	int N = nR * nC * nL;
	uint8 data[N * nB];
	for (int i = 0; i < nB * N; i++) {
		data[i] = 0;
	}
	CImageBCC<uint8> *imBCC = new CImageBCC<uint8>(data, nR, nC, nL, nB);
	double volume = 2.5;
	CImageBCC<uint8> *imBCC2 = new CImageBCC<uint8>(data, nR, nC, nL, nB, volume);
	double factor = cbrt(volume);

	CImageBCC<uint8> *imBCC1C1L = new CImageBCC<uint8>(data, N, 1, 1, 1);
	CImageBCC<uint8> *imBCC1R1L = new CImageBCC<uint8>(data, 1, N, 1, 1);
	CImageBCC<uint8> *imBCC1R1C = new CImageBCC<uint8>(data, 1, 1, N, 1);
	int n1 = 15, n2 = 14;
	CImageBCC<uint8> *imBCCRC = new CImageBCC<uint8>(data, n1, n2, 1, 1);
	CImageBCC<uint8> *imBCCRL = new CImageBCC<uint8>(data, n1, 1, n2, 1);
	CImageBCC<uint8> *imBCCCL = new CImageBCC<uint8>(data, 1, n1, n2, 1);
	vector<double> coordinates;

	// spel coordinates
	EXPECT_NEAR(imBCC->indexToX(0), BCCOFFSET, EPSILONT);
	EXPECT_NEAR(imBCC->indexToY(0), BCCOFFSET, EPSILONT);
	EXPECT_NEAR(imBCC->indexToZ(0), BCCOFFSET, EPSILONT);
	EXPECT_NEAR(imBCC->indexToX(82), BCCOFFSET + 4*BCCSQFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCC->indexToY(82), BCCOFFSET + 3*BCCSQFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCC->indexToZ(82), BCCOFFSET + BCCSQFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCC->indexToX(112), BCCOFFSET + 9*BCCOFFSET, EPSILONT);
	EXPECT_NEAR(imBCC->indexToY(112), BCCOFFSET + 7*BCCOFFSET, EPSILONT);
	EXPECT_NEAR(imBCC->indexToZ(112), BCCOFFSET + 3*BCCOFFSET, EPSILONT);
	EXPECT_NEAR(imBCC->indexToX(209), BCCOFFSET + 5*BCCSQFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCC->indexToY(209), BCCOFFSET + 4*BCCSQFACEDISTANCE, EPSILONT); // !!!!!!
	EXPECT_NEAR(imBCC->indexToZ(209), BCCOFFSET + 3*BCCSQFACEDISTANCE, EPSILONT);

	imBCC->getCoordinates(0,coordinates);
	EXPECT_NEAR(coordinates[0], BCCOFFSET, EPSILONT);
	EXPECT_NEAR(coordinates[1], BCCOFFSET, EPSILONT);
	EXPECT_NEAR(coordinates[2], BCCOFFSET, EPSILONT);
	imBCC->getCoordinates(82,coordinates);
	EXPECT_NEAR(coordinates[0], BCCOFFSET + 4*BCCSQFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(coordinates[1], BCCOFFSET + 3*BCCSQFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(coordinates[2], BCCOFFSET + BCCSQFACEDISTANCE, EPSILONT);
	imBCC->getCoordinates(112,coordinates);
	EXPECT_NEAR(coordinates[0], BCCOFFSET + 9*BCCOFFSET, EPSILONT);
	EXPECT_NEAR(coordinates[1], BCCOFFSET + 7*BCCOFFSET, EPSILONT);
	EXPECT_NEAR(coordinates[2], BCCOFFSET + 3*BCCOFFSET, EPSILONT);
	imBCC->getCoordinates(209,coordinates);
	EXPECT_NEAR(coordinates[0], BCCOFFSET + 5*BCCSQFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(coordinates[1], BCCOFFSET + 4*BCCSQFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(coordinates[2], BCCOFFSET + 3*BCCSQFACEDISTANCE, EPSILONT);


	EXPECT_NEAR(imBCC2->indexToX(0), factor * (BCCOFFSET), EPSILONT);
	EXPECT_NEAR(imBCC2->indexToY(0), factor * (BCCOFFSET), EPSILONT);
	EXPECT_NEAR(imBCC2->indexToZ(0), factor * (BCCOFFSET), EPSILONT);
	EXPECT_NEAR(imBCC2->indexToX(82), factor * (BCCOFFSET + 4*BCCSQFACEDISTANCE), EPSILONT);
	EXPECT_NEAR(imBCC2->indexToY(82), factor * (BCCOFFSET + 3*BCCSQFACEDISTANCE), EPSILONT);
	EXPECT_NEAR(imBCC2->indexToZ(82), factor * (BCCOFFSET + BCCSQFACEDISTANCE), EPSILONT);
	EXPECT_NEAR(imBCC2->indexToX(112), factor * (BCCOFFSET + 9*BCCOFFSET), EPSILONT);
	EXPECT_NEAR(imBCC2->indexToY(112), factor * (BCCOFFSET + 7*BCCOFFSET), EPSILONT);
	EXPECT_NEAR(imBCC2->indexToZ(112), factor * (BCCOFFSET + 3*BCCOFFSET), EPSILONT);
	EXPECT_NEAR(imBCC2->indexToX(209), factor * (BCCOFFSET + 5*BCCSQFACEDISTANCE), EPSILONT);
	EXPECT_NEAR(imBCC2->indexToY(209), factor * (BCCOFFSET + 4*BCCSQFACEDISTANCE), EPSILONT); // !!!!!!
	EXPECT_NEAR(imBCC2->indexToZ(209), factor * (BCCOFFSET + 3*BCCSQFACEDISTANCE), EPSILONT);

	// width, height and depth
	EXPECT_NEAR(imBCC->getWidth(), 6.5 * BCCSQFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCC->getHeight(), 5.5 * BCCSQFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCC->getDepth(), 4 * BCCSQFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCC2->getWidth(), factor * 6.5 * BCCSQFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCC2->getHeight(), factor * 5.5 * BCCSQFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCC2->getDepth(), factor * 4 * BCCSQFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCC1C1L->getWidth(), BCCSQFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCC1C1L->getHeight(), N * BCCSQFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCC1C1L->getDepth(), BCCSQFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCC1R1L->getWidth(), N * BCCSQFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCC1R1L->getHeight(), BCCSQFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCC1R1L->getDepth(), BCCSQFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCC1R1C->getWidth(), BCCSQFACEDISTANCE + BCCOFFSET, EPSILONT);
	EXPECT_NEAR(imBCC1R1C->getHeight(), BCCSQFACEDISTANCE + BCCOFFSET, EPSILONT);
	EXPECT_NEAR(imBCC1R1C->getDepth(), (N + 1) * BCCOFFSET, EPSILONT);

	EXPECT_NEAR(imBCCRC->getWidth(), n2 * BCCSQFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCCRC->getHeight(), n1 * BCCSQFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCCRC->getDepth(), BCCSQFACEDISTANCE, EPSILONT);

	EXPECT_NEAR(imBCCRL->getWidth(), BCCSQFACEDISTANCE + BCCOFFSET, EPSILONT);
	EXPECT_NEAR(imBCCRL->getHeight(), n1 * BCCSQFACEDISTANCE + BCCOFFSET, EPSILONT);
	EXPECT_NEAR(imBCCRL->getDepth(), (n2 + 1) * BCCOFFSET, EPSILONT);

	EXPECT_NEAR(imBCCCL->getWidth(), n1 * BCCSQFACEDISTANCE + BCCOFFSET, EPSILONT);
	EXPECT_NEAR(imBCCCL->getHeight(), BCCSQFACEDISTANCE + BCCOFFSET, EPSILONT);
	EXPECT_NEAR(imBCCCL->getDepth(), (n2 + 1) * BCCOFFSET, EPSILONT);

	delete imBCC;
	delete imBCC2;
	delete imBCC1C1L;
	delete imBCC1R1L;
	delete imBCC1R1C;
	delete imBCCCL;
	delete imBCCRL;
	delete imBCCRC;
}

TEST(CImageBCC, distances) {

	// set up image
	int nR = 5, nC = 6, nL = 7, nB = 3;
	int N = nR * nC * nL;
	uint8 data[N * nB];
	for (int i = 0; i < nB * N; i++) {
		data[i] = 0;
	}
	CImageBCC<uint8> *imBCC = new CImageBCC<uint8>(data, nR, nC, nL, nB);
	double volume = 2.5;
	CImageBCC<uint8> *imBCC2 = new CImageBCC<uint8>(data, nR, nC, nL, nB, volume);
	double factor = cbrt(volume);

	// distance between spels
	EXPECT_NEAR(imBCC->euclideanDistance(0, 0), 0, EPSILONT);
	EXPECT_NEAR(imBCC->euclideanDistance(170, 170), 0, EPSILONT);
	EXPECT_NEAR(imBCC->euclideanDistance(N - 1, N - 1), 0, EPSILONT);
	EXPECT_NEAR(imBCC->euclideanDistance(82, 45), BCCHEXFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCC->euclideanDistance(82, 45), imBCC->euclideanDistance(45, 82), EPSILONT);
	EXPECT_NEAR(imBCC->euclideanDistance(82, 46), BCCHEXFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCC->euclideanDistance(82, 46), imBCC->euclideanDistance(46, 82), EPSILONT);
	EXPECT_NEAR(imBCC->euclideanDistance(82, 51), BCCHEXFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCC->euclideanDistance(82, 51), imBCC->euclideanDistance(51, 82), EPSILONT);
	EXPECT_NEAR(imBCC->euclideanDistance(82, 52), BCCHEXFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCC->euclideanDistance(82, 52), imBCC->euclideanDistance(52, 82), EPSILONT);
	EXPECT_NEAR(imBCC->euclideanDistance(82, 22), BCCSQFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCC->euclideanDistance(82, 22), imBCC->euclideanDistance(22, 82), EPSILONT);
	EXPECT_NEAR(imBCC->euclideanDistance(82, 76), BCCSQFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCC->euclideanDistance(82, 76), imBCC->euclideanDistance(76, 82), EPSILONT);
	EXPECT_NEAR(imBCC->euclideanDistance(82, 83), BCCSQFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCC->euclideanDistance(82, 83), imBCC->euclideanDistance(83, 82), EPSILONT);

	EXPECT_NEAR(imBCC2->euclideanDistance(0, 0), 0, EPSILONT);
	EXPECT_NEAR(imBCC2->euclideanDistance(170, 170), 0, EPSILONT);
	EXPECT_NEAR(imBCC2->euclideanDistance(N - 1, N - 1), 0, EPSILONT);
	EXPECT_NEAR(imBCC2->euclideanDistance(82, 45), factor * BCCHEXFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCC2->euclideanDistance(82, 45), imBCC2->euclideanDistance(45, 82), EPSILONT);
	EXPECT_NEAR(imBCC2->euclideanDistance(82, 46), factor * BCCHEXFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCC2->euclideanDistance(82, 46), imBCC2->euclideanDistance(46, 82), EPSILONT);
	EXPECT_NEAR(imBCC2->euclideanDistance(82, 51), factor * BCCHEXFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCC2->euclideanDistance(82, 51), imBCC2->euclideanDistance(51, 82), EPSILONT);
	EXPECT_NEAR(imBCC2->euclideanDistance(82, 52), factor * BCCHEXFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCC2->euclideanDistance(82, 52), imBCC2->euclideanDistance(52, 82), EPSILONT);
	EXPECT_NEAR(imBCC2->euclideanDistance(82, 22), factor * BCCSQFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCC2->euclideanDistance(82, 22), imBCC2->euclideanDistance(22, 82), EPSILONT);
	EXPECT_NEAR(imBCC2->euclideanDistance(82, 76), factor * BCCSQFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCC2->euclideanDistance(82, 76), imBCC2->euclideanDistance(76, 82), EPSILONT);
	EXPECT_NEAR(imBCC2->euclideanDistance(82, 83), factor * BCCSQFACEDISTANCE, EPSILONT);
	EXPECT_NEAR(imBCC2->euclideanDistance(82, 83), imBCC2->euclideanDistance(83, 82), EPSILONT);

	vector<double> dv;
	double right[3] = { BCCSQFACEDISTANCE, 0, 0 };
	double bottom[3] = { 0, BCCSQFACEDISTANCE, 0 };
	double back[3] = { 0, 0, BCCSQFACEDISTANCE };
	double left[3] = { -BCCSQFACEDISTANCE, 0, 0 };
	double top[3] = { 0, -BCCSQFACEDISTANCE, 0 };
	double front[3] = { 0, 0, -BCCSQFACEDISTANCE };
	double ftl[3] = { -BCCOFFSET, -BCCOFFSET, -BCCOFFSET };
	double ftr[3] = { BCCOFFSET, -BCCOFFSET, -BCCOFFSET };
	double fbl[3] = { -BCCOFFSET, BCCOFFSET, -BCCOFFSET };
	double fbr[3] = { BCCOFFSET, BCCOFFSET, -BCCOFFSET };
	double btl[3] = { -BCCOFFSET, -BCCOFFSET, BCCOFFSET };
	double btr[3] = { BCCOFFSET, -BCCOFFSET, BCCOFFSET };
	double bbl[3] = { -BCCOFFSET, BCCOFFSET, BCCOFFSET };
	double bbr[3] = { BCCOFFSET, BCCOFFSET, BCCOFFSET };
	imBCC->euclideanDistanceVector(82, 82, dv);
    EXPECT_TRUE(fabs(dv[0]) < EPSILONT);
    EXPECT_TRUE(fabs(dv[1]) < EPSILONT);
    EXPECT_TRUE(fabs(dv[2]) < EPSILONT);
	imBCC->euclideanDistanceVector(82, 83, dv);
    EXPECT_NEAR(dv[0], right[0], EPSILONT);
    EXPECT_NEAR(dv[1], right[1], EPSILONT);
    EXPECT_NEAR(dv[2], right[2], EPSILONT);
	imBCC->euclideanDistanceVector(82, 88, dv);
    EXPECT_NEAR(dv[0], bottom[0], EPSILONT);
    EXPECT_NEAR(dv[1], bottom[1], EPSILONT);
    EXPECT_NEAR(dv[2], bottom[2], EPSILONT);
	imBCC->euclideanDistanceVector(22, 82, dv);
    EXPECT_NEAR(dv[0], back[0], EPSILONT);
    EXPECT_NEAR(dv[1], back[1], EPSILONT);
    EXPECT_NEAR(dv[2], back[2], EPSILONT);
	imBCC->euclideanDistanceVector(83, 82, dv);
    EXPECT_NEAR(dv[0], left[0], EPSILONT);
    EXPECT_NEAR(dv[1], left[1], EPSILONT);
    EXPECT_NEAR(dv[2], left[2], EPSILONT);
	imBCC->euclideanDistanceVector(88, 82, dv);
    EXPECT_NEAR(dv[0], top[0], EPSILONT);
    EXPECT_NEAR(dv[1], top[1], EPSILONT);
    EXPECT_NEAR(dv[2], top[2], EPSILONT);
	imBCC->euclideanDistanceVector(82, 22, dv);
    EXPECT_NEAR(dv[0], front[0], EPSILONT);
    EXPECT_NEAR(dv[1], front[1], EPSILONT);
    EXPECT_NEAR(dv[2], front[2], EPSILONT);
	imBCC->euclideanDistanceVector(82, 45, dv);
    EXPECT_NEAR(dv[0], ftl[0], EPSILONT);
    EXPECT_NEAR(dv[1], ftl[1], EPSILONT);
    EXPECT_NEAR(dv[2], ftl[2], EPSILONT);
	imBCC->euclideanDistanceVector(82, 46, dv);
    EXPECT_NEAR(dv[0], ftr[0], EPSILONT);
    EXPECT_NEAR(dv[1], ftr[1], EPSILONT);
    EXPECT_NEAR(dv[2], ftr[2], EPSILONT);
	imBCC->euclideanDistanceVector(82, 51, dv);
    EXPECT_NEAR(dv[0], fbl[0], EPSILONT);
    EXPECT_NEAR(dv[1], fbl[1], EPSILONT);
    EXPECT_NEAR(dv[2], fbl[2], EPSILONT);
	imBCC->euclideanDistanceVector(82, 52, dv);
    EXPECT_NEAR(dv[0], fbr[0], EPSILONT);
    EXPECT_NEAR(dv[1], fbr[1], EPSILONT);
    EXPECT_NEAR(dv[2], fbr[2], EPSILONT);
	imBCC->euclideanDistanceVector(82, 105, dv);
    EXPECT_NEAR(dv[0], btl[0], EPSILONT);
    EXPECT_NEAR(dv[1], btl[1], EPSILONT);
    EXPECT_NEAR(dv[2], btl[2], EPSILONT);
	imBCC->euclideanDistanceVector(82, 106, dv);
    EXPECT_NEAR(dv[0], btr[0], EPSILONT);
    EXPECT_NEAR(dv[1], btr[1], EPSILONT);
    EXPECT_NEAR(dv[2], btr[2], EPSILONT);
	imBCC->euclideanDistanceVector(82, 111, dv);
    EXPECT_NEAR(dv[0], bbl[0], EPSILONT);
    EXPECT_NEAR(dv[1], bbl[1], EPSILONT);
    EXPECT_NEAR(dv[2], bbl[2], EPSILONT);
	imBCC->euclideanDistanceVector(82, 112, dv);
    EXPECT_NEAR(dv[0], bbr[0], EPSILONT);
    EXPECT_NEAR(dv[1], bbr[1], EPSILONT);
    EXPECT_NEAR(dv[2], bbr[2], EPSILONT);

	double right2[3] = { factor * BCCSQFACEDISTANCE, 0, 0 };
	double bottom2[3] = { 0, factor * BCCSQFACEDISTANCE, 0 };
	double back2[3] = { 0, 0, factor * BCCSQFACEDISTANCE };
	double left2[3] = { -factor * BCCSQFACEDISTANCE, 0, 0 };
	double top2[3] = { 0, -factor * BCCSQFACEDISTANCE, 0 };
	double front2[3] = { 0, 0, -factor * BCCSQFACEDISTANCE };
	double ftl2[3] = { -factor * BCCOFFSET, -factor * BCCOFFSET, -factor * BCCOFFSET };
	double ftr2[3] = { factor * BCCOFFSET, -factor * BCCOFFSET, -factor * BCCOFFSET };
	double fbl2[3] = { -factor * BCCOFFSET, factor * BCCOFFSET, -factor * BCCOFFSET };
	double fbr2[3] = { factor * BCCOFFSET, factor * BCCOFFSET, -factor * BCCOFFSET };
	double btl2[3] = { -factor * BCCOFFSET, -factor * BCCOFFSET, factor * BCCOFFSET };
	double btr2[3] = { factor * BCCOFFSET, -factor * BCCOFFSET, factor * BCCOFFSET };
	double bbl2[3] = { -factor * BCCOFFSET, factor * BCCOFFSET, factor * BCCOFFSET };
	double bbr2[3] = { factor * BCCOFFSET, factor * BCCOFFSET, factor * BCCOFFSET };
	imBCC2->euclideanDistanceVector(82, 82, dv);
    EXPECT_TRUE(fabs(dv[0]) < EPSILONT);
    EXPECT_TRUE(fabs(dv[1]) < EPSILONT);
    EXPECT_TRUE(fabs(dv[2]) < EPSILONT);
	imBCC2->euclideanDistanceVector(82, 83, dv);
    EXPECT_NEAR(dv[0], right2[0], EPSILONT);
    EXPECT_NEAR(dv[1], right2[1], EPSILONT);
    EXPECT_NEAR(dv[2], right2[2], EPSILONT);
	imBCC2->euclideanDistanceVector(82, 88, dv);
    EXPECT_NEAR(dv[0], bottom2[0], EPSILONT);
    EXPECT_NEAR(dv[1], bottom2[1], EPSILONT);
    EXPECT_NEAR(dv[2], bottom2[2], EPSILONT);
	imBCC2->euclideanDistanceVector(22, 82, dv);
    EXPECT_NEAR(dv[0], back2[0], EPSILONT);
    EXPECT_NEAR(dv[1], back2[1], EPSILONT);
    EXPECT_NEAR(dv[2], back2[2], EPSILONT);
	imBCC2->euclideanDistanceVector(83, 82, dv);
    EXPECT_NEAR(dv[0], left2[0], EPSILONT);
    EXPECT_NEAR(dv[1], left2[1], EPSILONT);
    EXPECT_NEAR(dv[2], left2[2], EPSILONT);
	imBCC2->euclideanDistanceVector(88, 82, dv);
    EXPECT_NEAR(dv[0], top2[0], EPSILONT);
    EXPECT_NEAR(dv[1], top2[1], EPSILONT);
    EXPECT_NEAR(dv[2], top2[2], EPSILONT);
	imBCC2->euclideanDistanceVector(82, 22, dv);
    EXPECT_NEAR(dv[0], front2[0], EPSILONT);
    EXPECT_NEAR(dv[1], front2[1], EPSILONT);
    EXPECT_NEAR(dv[2], front2[2], EPSILONT);
	imBCC2->euclideanDistanceVector(82, 45, dv);
    EXPECT_NEAR(dv[0], ftl2[0], EPSILONT);
    EXPECT_NEAR(dv[1], ftl2[1], EPSILONT);
    EXPECT_NEAR(dv[2], ftl2[2], EPSILONT);
	imBCC2->euclideanDistanceVector(82, 46, dv);
    EXPECT_NEAR(dv[0], ftr2[0], EPSILONT);
    EXPECT_NEAR(dv[1], ftr2[1], EPSILONT);
    EXPECT_NEAR(dv[2], ftr2[2], EPSILONT);
	imBCC2->euclideanDistanceVector(82, 51, dv);
    EXPECT_NEAR(dv[0], fbl2[0], EPSILONT);
    EXPECT_NEAR(dv[1], fbl2[1], EPSILONT);
    EXPECT_NEAR(dv[2], fbl2[2], EPSILONT);
	imBCC2->euclideanDistanceVector(82, 52, dv);
    EXPECT_NEAR(dv[0], fbr2[0], EPSILONT);
    EXPECT_NEAR(dv[1], fbr2[1], EPSILONT);
    EXPECT_NEAR(dv[2], fbr2[2], EPSILONT);
	imBCC2->euclideanDistanceVector(82, 105, dv);
    EXPECT_NEAR(dv[0], btl2[0], EPSILONT);
    EXPECT_NEAR(dv[1], btl2[1], EPSILONT);
    EXPECT_NEAR(dv[2], btl2[2], EPSILONT);
	imBCC2->euclideanDistanceVector(82, 106, dv);
    EXPECT_NEAR(dv[0], btr2[0], EPSILONT);
    EXPECT_NEAR(dv[1], btr2[1], EPSILONT);
    EXPECT_NEAR(dv[2], btr2[2], EPSILONT);
	imBCC2->euclideanDistanceVector(82, 111, dv);
    EXPECT_NEAR(dv[0], bbl2[0], EPSILONT);
    EXPECT_NEAR(dv[1], bbl2[1], EPSILONT);
    EXPECT_NEAR(dv[2], bbl2[2], EPSILONT);
	imBCC2->euclideanDistanceVector(82, 112, dv);
    EXPECT_NEAR(dv[0], bbr2[0], EPSILONT);
    EXPECT_NEAR(dv[1], bbr2[1], EPSILONT);
    EXPECT_NEAR(dv[2], bbr2[2], EPSILONT);

	delete imBCC;
	delete imBCC2;
}

TEST(CImageBCC, neighbors) {
	/**
	 * Tests getNeighbor(r,c,l,N). Since all other methods
	 * always call getXNeighbors(r,c,l), those methods should work
	 * properly if the tests pass for this method and for
	 * indexTo[R,C,L]().
	 */

	// image parameters
	int nR = 5, nC = 6, nL = 7, nB = 3;
	int N = nR * nC * nL;
	uint8 data[N];
	for (int i = 0; i < N; i++) {
		data[i] = 0;
	}
	CImageBCC<uint8> *imBCC = new CImageBCC<uint8>(data, nR, nC, nL, nB);

	vector<Neighbor> neighbors;
	int nNeighbors, returnedNeighbors, correctNNeighbors;
	// neighbor indices
	// {tlf,trf,bolf,borf,tlba,trba,bolba,borba,   t,f,l,ba,r,bo}
	int BCC8EL[8] = { 45, 46, 51, 52, 105, 106, 111, 112 }; // {31,32,36,37,81,82,86,87};
	int BCC8OL[8] = { 82, 83, 88, 89, 142, 143, 148, 149 }; // {12,13,17,18,62,63,67,68};
	int BCC14EL[14] = { 45, 46, 51, 52, 105, 106, 111, 112, 76, 22, 81, 142, 83, 88 }; // {31,32,36,37,81,82,86,87,57,12,61,112,63,67};
	int BCC14OL[14] = { 82, 83, 88, 89, 142, 143, 148, 149, 106, 52, 111, 172, 113, 118 }; // {12,13,17,18,62,63,67,68,32,36,87,38,42};

	// 8 neighbors
	nNeighbors = 8;
	correctNNeighbors = 8;
	imBCC->getNeighbors(3, 4, 2, nNeighbors, neighbors);
	returnedNeighbors = neighbors.size();
	EXPECT_EQ(returnedNeighbors, correctNNeighbors);
    EXPECT_EQ(neighbors[0].getIndex(), BCC8EL[0]);
    EXPECT_EQ(neighbors[1].getIndex(), BCC8EL[1]);
    EXPECT_EQ(neighbors[2].getIndex(), BCC8EL[2]);
    EXPECT_EQ(neighbors[3].getIndex(), BCC8EL[3]);
    EXPECT_EQ(neighbors[4].getIndex(), BCC8EL[4]);
    EXPECT_EQ(neighbors[5].getIndex(), BCC8EL[5]);
    EXPECT_EQ(neighbors[6].getIndex(), BCC8EL[6]);
    EXPECT_EQ(neighbors[7].getIndex(), BCC8EL[7]);
	imBCC->getNeighbors(imBCC->rclToIndex(3, 4, 2), nNeighbors, neighbors);
	returnedNeighbors = neighbors.size();
    EXPECT_EQ(returnedNeighbors, correctNNeighbors);
    EXPECT_EQ(neighbors[0].getIndex(), BCC8EL[0]);
    EXPECT_EQ(neighbors[1].getIndex(), BCC8EL[1]);
    EXPECT_EQ(neighbors[2].getIndex(), BCC8EL[2]);
    EXPECT_EQ(neighbors[3].getIndex(), BCC8EL[3]);
    EXPECT_EQ(neighbors[4].getIndex(), BCC8EL[4]);
    EXPECT_EQ(neighbors[5].getIndex(), BCC8EL[5]);
    EXPECT_EQ(neighbors[6].getIndex(), BCC8EL[6]);
    EXPECT_EQ(neighbors[7].getIndex(), BCC8EL[7]);
	imBCC->getNeighbors(3, 4, 3, nNeighbors, neighbors);
	returnedNeighbors = neighbors.size();
    EXPECT_EQ(returnedNeighbors, correctNNeighbors);
    EXPECT_EQ(neighbors[0].getIndex(), BCC8OL[0]);
    EXPECT_EQ(neighbors[1].getIndex(), BCC8OL[1]);
    EXPECT_EQ(neighbors[2].getIndex(), BCC8OL[2]);
    EXPECT_EQ(neighbors[3].getIndex(), BCC8OL[3]);
    EXPECT_EQ(neighbors[4].getIndex(), BCC8OL[4]);
    EXPECT_EQ(neighbors[5].getIndex(), BCC8OL[5]);
    EXPECT_EQ(neighbors[6].getIndex(), BCC8OL[6]);
    EXPECT_EQ(neighbors[7].getIndex(), BCC8OL[7]);
	imBCC->getNeighbors(imBCC->rclToIndex(3, 4, 3), nNeighbors, neighbors);
	returnedNeighbors = neighbors.size();
    EXPECT_EQ(returnedNeighbors, correctNNeighbors);
    EXPECT_EQ(neighbors[0].getIndex(), BCC8OL[0]);
    EXPECT_EQ(neighbors[1].getIndex(), BCC8OL[1]);
    EXPECT_EQ(neighbors[2].getIndex(), BCC8OL[2]);
    EXPECT_EQ(neighbors[3].getIndex(), BCC8OL[3]);
    EXPECT_EQ(neighbors[4].getIndex(), BCC8OL[4]);
    EXPECT_EQ(neighbors[5].getIndex(), BCC8OL[5]);
    EXPECT_EQ(neighbors[6].getIndex(), BCC8OL[6]);
    EXPECT_EQ(neighbors[7].getIndex(), BCC8OL[7]);
	correctNNeighbors = 1;
	imBCC->getNeighbors(0, 0, 0, nNeighbors, neighbors);
	returnedNeighbors = neighbors.size();
    EXPECT_EQ(returnedNeighbors, correctNNeighbors);
	correctNNeighbors = 2;
	imBCC->getNeighbors(4, 0, 6, nNeighbors, neighbors);
	returnedNeighbors = neighbors.size();
    EXPECT_EQ(returnedNeighbors, correctNNeighbors);
	correctNNeighbors = 4;
	imBCC->getNeighbors(nR - 1, nC - 1, nL - 1, nNeighbors, neighbors);
	returnedNeighbors = neighbors.size();
    EXPECT_EQ(returnedNeighbors, correctNNeighbors);
	imBCC->getNeighbors(0, 5, 1, nNeighbors, neighbors);
	returnedNeighbors = neighbors.size();
    EXPECT_EQ(returnedNeighbors, correctNNeighbors);
	imBCC->getNeighbors(4, 0, 5, nNeighbors, neighbors);
	returnedNeighbors = neighbors.size();
    EXPECT_EQ(returnedNeighbors, correctNNeighbors);

	// 14 neighbors
	nNeighbors = 14;
	correctNNeighbors = 14;
	imBCC->getNeighbors(3, 4, 2, nNeighbors, neighbors);
	returnedNeighbors = neighbors.size();
    EXPECT_EQ(returnedNeighbors, correctNNeighbors);
    EXPECT_EQ(neighbors[0].getIndex(), BCC14EL[0]);
    EXPECT_EQ(neighbors[1].getIndex(), BCC14EL[1]);
    EXPECT_EQ(neighbors[2].getIndex(), BCC14EL[2]);
    EXPECT_EQ(neighbors[3].getIndex(), BCC14EL[3]);
    EXPECT_EQ(neighbors[4].getIndex(), BCC14EL[4]);
    EXPECT_EQ(neighbors[5].getIndex(), BCC14EL[5]);
    EXPECT_EQ(neighbors[6].getIndex(), BCC14EL[6]);
    EXPECT_EQ(neighbors[7].getIndex(), BCC14EL[7]);
    EXPECT_EQ(neighbors[8].getIndex(), BCC14EL[8]);
    EXPECT_EQ(neighbors[9].getIndex(), BCC14EL[9]);
    EXPECT_EQ(neighbors[10].getIndex(), BCC14EL[10]);
    EXPECT_EQ(neighbors[11].getIndex(), BCC14EL[11]);
    EXPECT_EQ(neighbors[12].getIndex(), BCC14EL[12]);
    EXPECT_EQ(neighbors[13].getIndex(), BCC14EL[13]);
	imBCC->getNeighbors(imBCC->rclToIndex(3, 4, 2), nNeighbors, neighbors);
	returnedNeighbors = neighbors.size();
    EXPECT_EQ(returnedNeighbors, correctNNeighbors);
    EXPECT_EQ(neighbors[0].getIndex(), BCC14EL[0]);
    EXPECT_EQ(neighbors[1].getIndex(), BCC14EL[1]);
    EXPECT_EQ(neighbors[2].getIndex(), BCC14EL[2]);
    EXPECT_EQ(neighbors[3].getIndex(), BCC14EL[3]);
    EXPECT_EQ(neighbors[4].getIndex(), BCC14EL[4]);
    EXPECT_EQ(neighbors[5].getIndex(), BCC14EL[5]);
    EXPECT_EQ(neighbors[6].getIndex(), BCC14EL[6]);
    EXPECT_EQ(neighbors[7].getIndex(), BCC14EL[7]);
    EXPECT_EQ(neighbors[8].getIndex(), BCC14EL[8]);
    EXPECT_EQ(neighbors[9].getIndex(), BCC14EL[9]);
    EXPECT_EQ(neighbors[10].getIndex(), BCC14EL[10]);
    EXPECT_EQ(neighbors[11].getIndex(), BCC14EL[11]);
    EXPECT_EQ(neighbors[12].getIndex(), BCC14EL[12]);
    EXPECT_EQ(neighbors[13].getIndex(), BCC14EL[13]);
	imBCC->getNeighbors(3, 4, 3, nNeighbors, neighbors);
	returnedNeighbors = neighbors.size();
    EXPECT_EQ(returnedNeighbors, correctNNeighbors);
    EXPECT_EQ(neighbors[0].getIndex(), BCC14OL[0]);
    EXPECT_EQ(neighbors[1].getIndex(), BCC14OL[1]);
    EXPECT_EQ(neighbors[2].getIndex(), BCC14OL[2]);
    EXPECT_EQ(neighbors[3].getIndex(), BCC14OL[3]);
    EXPECT_EQ(neighbors[4].getIndex(), BCC14OL[4]);
    EXPECT_EQ(neighbors[5].getIndex(), BCC14OL[5]);
    EXPECT_EQ(neighbors[6].getIndex(), BCC14OL[6]);
    EXPECT_EQ(neighbors[7].getIndex(), BCC14OL[7]);
    EXPECT_EQ(neighbors[8].getIndex(), BCC14OL[8]);
    EXPECT_EQ(neighbors[9].getIndex(), BCC14OL[9]);
    EXPECT_EQ(neighbors[10].getIndex(), BCC14OL[10]);
    EXPECT_EQ(neighbors[11].getIndex(), BCC14OL[11]);
    EXPECT_EQ(neighbors[12].getIndex(), BCC14OL[12]);
    EXPECT_EQ(neighbors[13].getIndex(), BCC14OL[13]);
	imBCC->getNeighbors(imBCC->rclToIndex(3, 4, 3), nNeighbors, neighbors);
	returnedNeighbors = neighbors.size();
    EXPECT_EQ(returnedNeighbors, correctNNeighbors);
    EXPECT_EQ(neighbors[0].getIndex(), BCC14OL[0]);
    EXPECT_EQ(neighbors[1].getIndex(), BCC14OL[1]);
    EXPECT_EQ(neighbors[2].getIndex(), BCC14OL[2]);
    EXPECT_EQ(neighbors[3].getIndex(), BCC14OL[3]);
    EXPECT_EQ(neighbors[4].getIndex(), BCC14OL[4]);
    EXPECT_EQ(neighbors[5].getIndex(), BCC14OL[5]);
    EXPECT_EQ(neighbors[6].getIndex(), BCC14OL[6]);
    EXPECT_EQ(neighbors[7].getIndex(), BCC14OL[7]);
    EXPECT_EQ(neighbors[8].getIndex(), BCC14OL[8]);
    EXPECT_EQ(neighbors[9].getIndex(), BCC14OL[9]);
    EXPECT_EQ(neighbors[10].getIndex(), BCC14OL[10]);
    EXPECT_EQ(neighbors[11].getIndex(), BCC14OL[11]);
    EXPECT_EQ(neighbors[12].getIndex(), BCC14OL[12]);
    EXPECT_EQ(neighbors[13].getIndex(), BCC14OL[13]);
	correctNNeighbors = 4;
	imBCC->getNeighbors(0, 0, 0, nNeighbors, neighbors);
	returnedNeighbors = neighbors.size();
    EXPECT_EQ(returnedNeighbors, correctNNeighbors);
	correctNNeighbors = 5;
	imBCC->getNeighbors(4, 0, 6, nNeighbors, neighbors);
	returnedNeighbors = neighbors.size();
    EXPECT_EQ(returnedNeighbors, correctNNeighbors);
	correctNNeighbors = 7;
	imBCC->getNeighbors(nR - 1, nC - 1, nL - 1, nNeighbors, neighbors);
	returnedNeighbors = neighbors.size();
    EXPECT_EQ(returnedNeighbors, correctNNeighbors);
	imBCC->getNeighbors(0, 5, 1, nNeighbors, neighbors);
	returnedNeighbors = neighbors.size();
    EXPECT_EQ(returnedNeighbors, correctNNeighbors);
	imBCC->getNeighbors(4, 0, 5, nNeighbors, neighbors);
	returnedNeighbors = neighbors.size();
    EXPECT_EQ(returnedNeighbors, correctNNeighbors);

	// Exceptions
	nNeighbors = 8;
	EXPECT_THROW(imBCC->getNeighbors(nR, 0, 0, nNeighbors, neighbors), outsideImageException);
	EXPECT_THROW(imBCC->getNeighbors(-1, 0, 0, nNeighbors, neighbors), outsideImageException);
	EXPECT_THROW(imBCC->getNeighbors(0, nC, 0, nNeighbors, neighbors), outsideImageException);
	EXPECT_THROW(imBCC->getNeighbors(0, -1, 0, nNeighbors, neighbors), outsideImageException);
	EXPECT_THROW(imBCC->getNeighbors(0, 0, nL, nNeighbors, neighbors), outsideImageException);
	EXPECT_THROW(imBCC->getNeighbors(0, 0, -1, nNeighbors, neighbors), outsideImageException);
	nNeighbors = 14;
	EXPECT_THROW(imBCC->getNeighbors(nR, 0, 0, nNeighbors, neighbors), outsideImageException);
	EXPECT_THROW(imBCC->getNeighbors(-1, 0, 0, nNeighbors, neighbors), outsideImageException);
	EXPECT_THROW(imBCC->getNeighbors(0, nC, 0, nNeighbors, neighbors), outsideImageException);
	EXPECT_THROW(imBCC->getNeighbors(0, -1, 0, nNeighbors, neighbors), outsideImageException);
	EXPECT_THROW(imBCC->getNeighbors(0, 0, nL, nNeighbors, neighbors), outsideImageException);
	EXPECT_THROW(imBCC->getNeighbors(0, 0, -1, nNeighbors, neighbors), outsideImageException);
	nNeighbors = 6;
	EXPECT_THROW(imBCC->getNeighbors(0, 0, 0, nNeighbors, neighbors), nNeighborsException);
	nNeighbors = 12;
	EXPECT_THROW(imBCC->getNeighbors(0, 0, 0, nNeighbors, neighbors), nNeighborsException);
	nNeighbors = 18;
	EXPECT_THROW(imBCC->getNeighbors(0, 0, 0, nNeighbors, neighbors), nNeighborsException);
	nNeighbors = 26;
	EXPECT_THROW(imBCC->getNeighbors(0, 0, 0, nNeighbors, neighbors), nNeighborsException);
	nNeighbors = -8;
	EXPECT_THROW(imBCC->getNeighbors(0, 0, 0, nNeighbors, neighbors), nNeighborsException);
	nNeighbors = 0;
	EXPECT_THROW(imBCC->getNeighbors(0, 0, 0, nNeighbors, neighbors), nNeighborsException);
	nNeighbors = 100;
	EXPECT_THROW(imBCC->getNeighbors(0, 0, 0, nNeighbors, neighbors), nNeighborsException);

	delete imBCC;
}

TEST(CImageBCC, bands) {

    int nR = 2, nC = 3, nL = 4, nB = 5;
    int N = nR * nC * nL;
    double data[] = {1, 2, 3, 4, 5, 6,
            2, 3, 4, 5, 6, 1,
            3, 4, 5, 6, 1, 2,
            4, 5, 6, 1, 2, 3,

            11, 12, 13, 14, 15, 16,
            12, 13, 14, 15, 16, 11,
            13, 14, 15, 16, 11, 12,
            14, 15, 16, 11, 12, 13,

            21, 22, 23, 24, 25, 26,
            22, 23, 24, 25, 26, 21,
            23, 24, 25, 26, 21, 22,
            24, 25, 26, 21, 22, 23,

            31, 32, 33, 34, 35, 36,
            32, 33, 34, 35, 36, 31,
            33, 34, 35, 36, 31, 32,
            34, 35, 36, 31, 32, 33,

            41, 42, 43, 44, 45, 46,
            42, 43, 44, 45, 46, 41,
            43, 44, 45, 46, 41, 42,
            44, 45, 46, 41, 42, 43};

    CImageBCC<double> *imBCC = new CImageBCC<double>(data, nR, nC, nL, nB);

    // setElement
    double intensities[] = {1.1, 2.2, 3.3, 4.4, 5.5, 6.6};
    vector<double> intensities0(nB, 0.0);
    vector<double> intensitiesRight, intensitiesShort, intensitiesLong, originalIntensity;
    intensitiesShort.assign(intensities, intensities + 4);
    intensitiesRight.assign(intensities, intensities + 5);
    intensitiesLong.assign(intensities, intensities + 6);

    int index = 0;
    originalIntensity = (*imBCC)[index];
    imBCC->setElement(index, intensities0);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), 0, EPSILONT);
    imBCC->setElement(index, intensitiesRight);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), intensitiesRight[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), intensitiesRight[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), intensitiesRight[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), intensitiesRight[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), intensitiesRight[4], EPSILONT);
    imBCC->setElement(index, originalIntensity);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), originalIntensity[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), originalIntensity[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), originalIntensity[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), originalIntensity[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), originalIntensity[4], EPSILONT);
    index = 1;
    originalIntensity = (*imBCC)[index];
    imBCC->setElement(index, intensities0);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), 0, EPSILONT);
    imBCC->setElement(index, intensitiesRight);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), intensitiesRight[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), intensitiesRight[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), intensitiesRight[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), intensitiesRight[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), intensitiesRight[4], EPSILONT);
    imBCC->setElement(index, originalIntensity);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), originalIntensity[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), originalIntensity[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), originalIntensity[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), originalIntensity[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), originalIntensity[4], EPSILONT);
    index = 2;
    originalIntensity = (*imBCC)[index];
    imBCC->setElement(index, intensities0);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), 0, EPSILONT);
    imBCC->setElement(index, intensitiesRight);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), intensitiesRight[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), intensitiesRight[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), intensitiesRight[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), intensitiesRight[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), intensitiesRight[4], EPSILONT);
    imBCC->setElement(index, originalIntensity);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), originalIntensity[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), originalIntensity[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), originalIntensity[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), originalIntensity[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), originalIntensity[4], EPSILONT);
    index = 3;
    originalIntensity = (*imBCC)[index];
    imBCC->setElement(index, intensities0);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), 0, EPSILONT);
    imBCC->setElement(index, intensitiesRight);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), intensitiesRight[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), intensitiesRight[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), intensitiesRight[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), intensitiesRight[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), intensitiesRight[4], EPSILONT);
    imBCC->setElement(index, originalIntensity);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), originalIntensity[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), originalIntensity[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), originalIntensity[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), originalIntensity[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), originalIntensity[4], EPSILONT);
    index = 4;
    originalIntensity = (*imBCC)[index];
    imBCC->setElement(index, intensities0);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), 0, EPSILONT);
    imBCC->setElement(index, intensitiesRight);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), intensitiesRight[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), intensitiesRight[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), intensitiesRight[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), intensitiesRight[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), intensitiesRight[4], EPSILONT);
    imBCC->setElement(index, originalIntensity);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), originalIntensity[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), originalIntensity[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), originalIntensity[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), originalIntensity[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), originalIntensity[4], EPSILONT);
    index = 5;
    originalIntensity = (*imBCC)[index];
    imBCC->setElement(index, intensities0);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), 0, EPSILONT);
    imBCC->setElement(index, intensitiesRight);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), intensitiesRight[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), intensitiesRight[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), intensitiesRight[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), intensitiesRight[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), intensitiesRight[4], EPSILONT);
    imBCC->setElement(index, originalIntensity);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), originalIntensity[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), originalIntensity[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), originalIntensity[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), originalIntensity[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), originalIntensity[4], EPSILONT);
    index = 6;
    originalIntensity = (*imBCC)[index];
    imBCC->setElement(index, intensities0);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), 0, EPSILONT);
    imBCC->setElement(index, intensitiesRight);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), intensitiesRight[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), intensitiesRight[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), intensitiesRight[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), intensitiesRight[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), intensitiesRight[4], EPSILONT);
    imBCC->setElement(index, originalIntensity);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), originalIntensity[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), originalIntensity[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), originalIntensity[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), originalIntensity[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), originalIntensity[4], EPSILONT);
    index = 7;
    originalIntensity = (*imBCC)[index];
    imBCC->setElement(index, intensities0);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), 0, EPSILONT);
    imBCC->setElement(index, intensitiesRight);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), intensitiesRight[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), intensitiesRight[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), intensitiesRight[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), intensitiesRight[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), intensitiesRight[4], EPSILONT);
    imBCC->setElement(index, originalIntensity);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), originalIntensity[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), originalIntensity[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), originalIntensity[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), originalIntensity[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), originalIntensity[4], EPSILONT);
    index = 8;
    originalIntensity = (*imBCC)[index];
    imBCC->setElement(index, intensities0);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), 0, EPSILONT);
    imBCC->setElement(index, intensitiesRight);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), intensitiesRight[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), intensitiesRight[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), intensitiesRight[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), intensitiesRight[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), intensitiesRight[4], EPSILONT);
    imBCC->setElement(index, originalIntensity);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), originalIntensity[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), originalIntensity[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), originalIntensity[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), originalIntensity[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), originalIntensity[4], EPSILONT);
    index = 9;
    originalIntensity = (*imBCC)[index];
    imBCC->setElement(index, intensities0);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), 0, EPSILONT);
    imBCC->setElement(index, intensitiesRight);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), intensitiesRight[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), intensitiesRight[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), intensitiesRight[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), intensitiesRight[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), intensitiesRight[4], EPSILONT);
    imBCC->setElement(index, originalIntensity);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), originalIntensity[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), originalIntensity[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), originalIntensity[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), originalIntensity[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), originalIntensity[4], EPSILONT);
    index = 10;
    originalIntensity = (*imBCC)[index];
    imBCC->setElement(index, intensities0);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), 0, EPSILONT);
    imBCC->setElement(index, intensitiesRight);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), intensitiesRight[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), intensitiesRight[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), intensitiesRight[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), intensitiesRight[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), intensitiesRight[4], EPSILONT);
    imBCC->setElement(index, originalIntensity);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), originalIntensity[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), originalIntensity[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), originalIntensity[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), originalIntensity[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), originalIntensity[4], EPSILONT);
    index = 11;
    originalIntensity = (*imBCC)[index];
    imBCC->setElement(index, intensities0);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), 0, EPSILONT);
    imBCC->setElement(index, intensitiesRight);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), intensitiesRight[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), intensitiesRight[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), intensitiesRight[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), intensitiesRight[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), intensitiesRight[4], EPSILONT);
    imBCC->setElement(index, originalIntensity);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), originalIntensity[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), originalIntensity[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), originalIntensity[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), originalIntensity[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), originalIntensity[4], EPSILONT);
    index = 12;
    originalIntensity = (*imBCC)[index];
    imBCC->setElement(index, intensities0);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), 0, EPSILONT);
    imBCC->setElement(index, intensitiesRight);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), intensitiesRight[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), intensitiesRight[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), intensitiesRight[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), intensitiesRight[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), intensitiesRight[4], EPSILONT);
    imBCC->setElement(index, originalIntensity);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), originalIntensity[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), originalIntensity[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), originalIntensity[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), originalIntensity[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), originalIntensity[4], EPSILONT);
    index = 13;
    originalIntensity = (*imBCC)[index];
    imBCC->setElement(index, intensities0);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), 0, EPSILONT);
    imBCC->setElement(index, intensitiesRight);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), intensitiesRight[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), intensitiesRight[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), intensitiesRight[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), intensitiesRight[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), intensitiesRight[4], EPSILONT);
    imBCC->setElement(index, originalIntensity);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), originalIntensity[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), originalIntensity[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), originalIntensity[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), originalIntensity[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), originalIntensity[4], EPSILONT);
    index = 14;
    originalIntensity = (*imBCC)[index];
    imBCC->setElement(index, intensities0);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), 0, EPSILONT);
    imBCC->setElement(index, intensitiesRight);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), intensitiesRight[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), intensitiesRight[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), intensitiesRight[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), intensitiesRight[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), intensitiesRight[4], EPSILONT);
    imBCC->setElement(index, originalIntensity);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), originalIntensity[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), originalIntensity[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), originalIntensity[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), originalIntensity[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), originalIntensity[4], EPSILONT);
    index = 15;
    originalIntensity = (*imBCC)[index];
    imBCC->setElement(index, intensities0);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), 0, EPSILONT);
    imBCC->setElement(index, intensitiesRight);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), intensitiesRight[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), intensitiesRight[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), intensitiesRight[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), intensitiesRight[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), intensitiesRight[4], EPSILONT);
    imBCC->setElement(index, originalIntensity);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), originalIntensity[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), originalIntensity[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), originalIntensity[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), originalIntensity[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), originalIntensity[4], EPSILONT);
    index = 16;
    originalIntensity = (*imBCC)[index];
    imBCC->setElement(index, intensities0);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), 0, EPSILONT);
    imBCC->setElement(index, intensitiesRight);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), intensitiesRight[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), intensitiesRight[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), intensitiesRight[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), intensitiesRight[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), intensitiesRight[4], EPSILONT);
    imBCC->setElement(index, originalIntensity);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), originalIntensity[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), originalIntensity[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), originalIntensity[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), originalIntensity[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), originalIntensity[4], EPSILONT);
    index = 17;
    originalIntensity = (*imBCC)[index];
    imBCC->setElement(index, intensities0);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), 0, EPSILONT);
    imBCC->setElement(index, intensitiesRight);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), intensitiesRight[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), intensitiesRight[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), intensitiesRight[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), intensitiesRight[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), intensitiesRight[4], EPSILONT);
    imBCC->setElement(index, originalIntensity);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), originalIntensity[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), originalIntensity[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), originalIntensity[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), originalIntensity[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), originalIntensity[4], EPSILONT);
    index = 18;
    originalIntensity = (*imBCC)[index];
    imBCC->setElement(index, intensities0);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), 0, EPSILONT);
    imBCC->setElement(index, intensitiesRight);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), intensitiesRight[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), intensitiesRight[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), intensitiesRight[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), intensitiesRight[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), intensitiesRight[4], EPSILONT);
    imBCC->setElement(index, originalIntensity);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), originalIntensity[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), originalIntensity[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), originalIntensity[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), originalIntensity[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), originalIntensity[4], EPSILONT);
    index = 19;
    originalIntensity = (*imBCC)[index];
    imBCC->setElement(index, intensities0);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), 0, EPSILONT);
    imBCC->setElement(index, intensitiesRight);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), intensitiesRight[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), intensitiesRight[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), intensitiesRight[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), intensitiesRight[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), intensitiesRight[4], EPSILONT);
    imBCC->setElement(index, originalIntensity);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), originalIntensity[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), originalIntensity[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), originalIntensity[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), originalIntensity[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), originalIntensity[4], EPSILONT);
    index = 20;
    originalIntensity = (*imBCC)[index];
    imBCC->setElement(index, intensities0);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), 0, EPSILONT);
    imBCC->setElement(index, intensitiesRight);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), intensitiesRight[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), intensitiesRight[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), intensitiesRight[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), intensitiesRight[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), intensitiesRight[4], EPSILONT);
    imBCC->setElement(index, originalIntensity);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), originalIntensity[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), originalIntensity[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), originalIntensity[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), originalIntensity[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), originalIntensity[4], EPSILONT);
    index = 21;
    originalIntensity = (*imBCC)[index];
    imBCC->setElement(index, intensities0);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), 0, EPSILONT);
    imBCC->setElement(index, intensitiesRight);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), intensitiesRight[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), intensitiesRight[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), intensitiesRight[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), intensitiesRight[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), intensitiesRight[4], EPSILONT);
    imBCC->setElement(index, originalIntensity);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), originalIntensity[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), originalIntensity[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), originalIntensity[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), originalIntensity[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), originalIntensity[4], EPSILONT);
    index = 22;
    originalIntensity = (*imBCC)[index];
    imBCC->setElement(index, intensities0);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), 0, EPSILONT);
    imBCC->setElement(index, intensitiesRight);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), intensitiesRight[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), intensitiesRight[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), intensitiesRight[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), intensitiesRight[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), intensitiesRight[4], EPSILONT);
    imBCC->setElement(index, originalIntensity);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), originalIntensity[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), originalIntensity[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), originalIntensity[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), originalIntensity[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), originalIntensity[4], EPSILONT);
    index = 23;
    originalIntensity = (*imBCC)[index];
    imBCC->setElement(index, intensities0);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), 0, EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), 0, EPSILONT);
    imBCC->setElement(index, intensitiesRight);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), intensitiesRight[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), intensitiesRight[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), intensitiesRight[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), intensitiesRight[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), intensitiesRight[4], EPSILONT);
    imBCC->setElement(index, originalIntensity);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 0), originalIntensity[0], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 1), originalIntensity[1], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 2), originalIntensity[2], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 3), originalIntensity[3], EPSILONT);
    EXPECT_NEAR((*imBCC)(imBCC->indexToR(index), imBCC->indexToC(index), imBCC->indexToL(index), 4), originalIntensity[4], EPSILONT);

    double *newData = imBCC->getData();
    EXPECT_NEAR(data[0], newData[0], EPSILONT);
    EXPECT_NEAR(data[1], newData[1], EPSILONT);
    EXPECT_NEAR(data[2], newData[2], EPSILONT);
    EXPECT_NEAR(data[3], newData[3], EPSILONT);
    EXPECT_NEAR(data[4], newData[4], EPSILONT);
    EXPECT_NEAR(data[5], newData[5], EPSILONT);
    EXPECT_NEAR(data[6], newData[6], EPSILONT);
    EXPECT_NEAR(data[7], newData[7], EPSILONT);
    EXPECT_NEAR(data[8], newData[8], EPSILONT);
    EXPECT_NEAR(data[9], newData[9], EPSILONT);
    EXPECT_NEAR(data[10], newData[10], EPSILONT);
    EXPECT_NEAR(data[11], newData[11], EPSILONT);
    EXPECT_NEAR(data[12], newData[12], EPSILONT);
    EXPECT_NEAR(data[13], newData[13], EPSILONT);
    EXPECT_NEAR(data[14], newData[14], EPSILONT);
    EXPECT_NEAR(data[15], newData[15], EPSILONT);
    EXPECT_NEAR(data[16], newData[16], EPSILONT);
    EXPECT_NEAR(data[17], newData[17], EPSILONT);
    EXPECT_NEAR(data[18], newData[18], EPSILONT);
    EXPECT_NEAR(data[19], newData[19], EPSILONT);
    EXPECT_NEAR(data[20], newData[20], EPSILONT);
    EXPECT_NEAR(data[21], newData[21], EPSILONT);
    EXPECT_NEAR(data[22], newData[22], EPSILONT);
    EXPECT_NEAR(data[23], newData[23], EPSILONT);

    EXPECT_NEAR(data[24], newData[24], EPSILONT);
    EXPECT_NEAR(data[25], newData[25], EPSILONT);
    EXPECT_NEAR(data[26], newData[26], EPSILONT);
    EXPECT_NEAR(data[27], newData[27], EPSILONT);
    EXPECT_NEAR(data[28], newData[28], EPSILONT);
    EXPECT_NEAR(data[29], newData[29], EPSILONT);
    EXPECT_NEAR(data[30], newData[30], EPSILONT);
    EXPECT_NEAR(data[31], newData[31], EPSILONT);
    EXPECT_NEAR(data[32], newData[32], EPSILONT);
    EXPECT_NEAR(data[33], newData[33], EPSILONT);
    EXPECT_NEAR(data[34], newData[34], EPSILONT);
    EXPECT_NEAR(data[35], newData[35], EPSILONT);
    EXPECT_NEAR(data[36], newData[36], EPSILONT);
    EXPECT_NEAR(data[37], newData[37], EPSILONT);
    EXPECT_NEAR(data[38], newData[38], EPSILONT);
    EXPECT_NEAR(data[39], newData[39], EPSILONT);
    EXPECT_NEAR(data[40], newData[40], EPSILONT);
    EXPECT_NEAR(data[41], newData[41], EPSILONT);
    EXPECT_NEAR(data[42], newData[42], EPSILONT);
    EXPECT_NEAR(data[43], newData[43], EPSILONT);
    EXPECT_NEAR(data[44], newData[44], EPSILONT);
    EXPECT_NEAR(data[45], newData[45], EPSILONT);
    EXPECT_NEAR(data[46], newData[46], EPSILONT);
    EXPECT_NEAR(data[47], newData[47], EPSILONT);

    EXPECT_NEAR(data[48], newData[48], EPSILONT);
    EXPECT_NEAR(data[49], newData[49], EPSILONT);
    EXPECT_NEAR(data[50], newData[50], EPSILONT);
    EXPECT_NEAR(data[51], newData[51], EPSILONT);
    EXPECT_NEAR(data[52], newData[52], EPSILONT);
    EXPECT_NEAR(data[53], newData[53], EPSILONT);
    EXPECT_NEAR(data[54], newData[54], EPSILONT);
    EXPECT_NEAR(data[55], newData[55], EPSILONT);
    EXPECT_NEAR(data[56], newData[56], EPSILONT);
    EXPECT_NEAR(data[57], newData[57], EPSILONT);
    EXPECT_NEAR(data[58], newData[58], EPSILONT);
    EXPECT_NEAR(data[59], newData[59], EPSILONT);
    EXPECT_NEAR(data[60], newData[60], EPSILONT);
    EXPECT_NEAR(data[61], newData[61], EPSILONT);
    EXPECT_NEAR(data[62], newData[62], EPSILONT);
    EXPECT_NEAR(data[63], newData[63], EPSILONT);
    EXPECT_NEAR(data[64], newData[64], EPSILONT);
    EXPECT_NEAR(data[65], newData[65], EPSILONT);
    EXPECT_NEAR(data[66], newData[66], EPSILONT);
    EXPECT_NEAR(data[67], newData[67], EPSILONT);
    EXPECT_NEAR(data[68], newData[68], EPSILONT);
    EXPECT_NEAR(data[69], newData[69], EPSILONT);
    EXPECT_NEAR(data[70], newData[70], EPSILONT);
    EXPECT_NEAR(data[71], newData[71], EPSILONT);

    EXPECT_NEAR(data[72], newData[72], EPSILONT);
    EXPECT_NEAR(data[73], newData[73], EPSILONT);
    EXPECT_NEAR(data[74], newData[74], EPSILONT);
    EXPECT_NEAR(data[75], newData[75], EPSILONT);
    EXPECT_NEAR(data[76], newData[76], EPSILONT);
    EXPECT_NEAR(data[77], newData[77], EPSILONT);
    EXPECT_NEAR(data[78], newData[78], EPSILONT);
    EXPECT_NEAR(data[79], newData[79], EPSILONT);
    EXPECT_NEAR(data[80], newData[80], EPSILONT);
    EXPECT_NEAR(data[81], newData[81], EPSILONT);
    EXPECT_NEAR(data[82], newData[82], EPSILONT);
    EXPECT_NEAR(data[83], newData[83], EPSILONT);
    EXPECT_NEAR(data[84], newData[84], EPSILONT);
    EXPECT_NEAR(data[85], newData[85], EPSILONT);
    EXPECT_NEAR(data[86], newData[86], EPSILONT);
    EXPECT_NEAR(data[87], newData[87], EPSILONT);
    EXPECT_NEAR(data[88], newData[88], EPSILONT);
    EXPECT_NEAR(data[89], newData[89], EPSILONT);
    EXPECT_NEAR(data[90], newData[90], EPSILONT);
    EXPECT_NEAR(data[91], newData[91], EPSILONT);
    EXPECT_NEAR(data[92], newData[92], EPSILONT);
    EXPECT_NEAR(data[93], newData[93], EPSILONT);
    EXPECT_NEAR(data[94], newData[94], EPSILONT);
    EXPECT_NEAR(data[95], newData[95], EPSILONT);

    EXPECT_NEAR(data[96], newData[96], EPSILONT);
    EXPECT_NEAR(data[97], newData[97], EPSILONT);
    EXPECT_NEAR(data[98], newData[98], EPSILONT);
    EXPECT_NEAR(data[99], newData[99], EPSILONT);
    EXPECT_NEAR(data[100], newData[100], EPSILONT);
    EXPECT_NEAR(data[101], newData[101], EPSILONT);
    EXPECT_NEAR(data[102], newData[102], EPSILONT);
    EXPECT_NEAR(data[103], newData[103], EPSILONT);
    EXPECT_NEAR(data[104], newData[104], EPSILONT);
    EXPECT_NEAR(data[105], newData[105], EPSILONT);
    EXPECT_NEAR(data[106], newData[106], EPSILONT);
    EXPECT_NEAR(data[107], newData[107], EPSILONT);
    EXPECT_NEAR(data[108], newData[108], EPSILONT);
    EXPECT_NEAR(data[109], newData[109], EPSILONT);
    EXPECT_NEAR(data[110], newData[110], EPSILONT);
    EXPECT_NEAR(data[111], newData[111], EPSILONT);
    EXPECT_NEAR(data[112], newData[112], EPSILONT);
    EXPECT_NEAR(data[113], newData[113], EPSILONT);
    EXPECT_NEAR(data[114], newData[114], EPSILONT);
    EXPECT_NEAR(data[115], newData[115], EPSILONT);
    EXPECT_NEAR(data[116], newData[116], EPSILONT);
    EXPECT_NEAR(data[117], newData[117], EPSILONT);
    EXPECT_NEAR(data[118], newData[118], EPSILONT);
    EXPECT_NEAR(data[119], newData[119], EPSILONT);

    EXPECT_THROW(imBCC->setElement(-1, intensitiesRight), outsideImageException);
    EXPECT_THROW(imBCC->setElement(N, intensitiesRight), outsideImageException);
    EXPECT_THROW(imBCC->setElement(1, intensitiesShort), dimensionMismatchException);
    EXPECT_THROW(imBCC->setElement(1, intensitiesLong), dimensionMismatchException);

    EXPECT_THROW(imBCC->setElement(-1, 1, 1, intensitiesRight), outsideImageException);
    EXPECT_THROW(imBCC->setElement(1, -1, 1, intensitiesRight), outsideImageException);
    EXPECT_THROW(imBCC->setElement(1, 1, -1, intensitiesRight), outsideImageException);
    EXPECT_THROW(imBCC->setElement(1, intensitiesShort), dimensionMismatchException);
    EXPECT_THROW(imBCC->setElement(1, intensitiesLong), dimensionMismatchException);
}

#endif